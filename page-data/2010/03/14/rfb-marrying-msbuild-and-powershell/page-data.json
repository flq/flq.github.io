{"componentChunkName":"component---src-templates-article-template-js","path":"/2010/03/14/rfb-marrying-msbuild-and-powershell","result":{"data":{"markdownRemark":{"html":"<p>I have previously written about <a href=\"/go/160\">rfb, MsBuild without XML</a>. It took me longer than expected to support this script, but itâ€™s available in the current source now:</p>\n <div style=\"padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px\" id=\"scid:812469c5-0cb0-4c63-8c15-c81123a09de7:ceb951f9-aff1-4dc4-8e62-9fd02f3f14b4\" class=\"wlWriterEditableSmartContent\"><pre name=\"code\" class=\"c#\">Project \"Default\"\n<p>  Target \"Default\"\n@files &#x3C;= smallPNGs -Capture:FullName, Extension\nMessage \"%(files.Identity) and extension %(files.Extension)\"</p>\n<p>  PS:smallPNGs &#x3C;&#x3C;END\necho \"Returning small pngs\"\ncd C:\\users\\xyz\\Documents\nGet-ChildItem -Recurse |\nWhere-Object { $<em>.Extension -eq \".png\" -and $</em>.Length -lt 7000 } |\nselect FullName, Extension\nEND</p>\n</pre></div>\n<p>The syntax used is described in more detail in the <a href=\"http://wiki.github.com/flq/rfb/syntax-powershell-integration\">new syntax section</a> on the rfb source site wiki. </p>\n<p>What happens is that this is the first of a couple of use cases surrounding a seamless integration of PowerShell with MSBuild. So far, you can define PowerShell.scripts, use them to fill item groups, and use those item groups in MSBuild tasks. <del>When the integration is feature complete you will be able to</del>The integration allows you to</p>\n<ul>\n<li>\n<p>Capture a single output value of PowerShell directly into a property </p>\n<li>Run a PowerShell script without expecting any output \n<li>Write the PowerShell scripts inline in your targets as if they were MsBuild tasks \n<li>Pass parameters into your script \n<li>Have the PowerShell scripts log into the same Console that rfb is running in.[![Shout it](http://dotnetshoutout.com/image.axd?url=http%3A%2F%2Frealfiction.net%2Fgo%2F162)](http://dotnetshoutout.com/realfiction-rfb-Marrying-MSBuild-and-PowerShell)\n</li>\n</ul>","fields":{"slug":"/2010/03/14/rfb-marrying-msbuild-and-powershell"},"frontmatter":{"date":"March 14, 2010","path":null,"title":"rfb: Marrying MSBuild and PowerShell","tags":["dotnet","msbuild","tools","own-software"]}}},"pageContext":{"title":"rfb: Marrying MSBuild and PowerShell","previous":{"fields":{"slug":"/2010/03/10/das-neue-ministerkabinett","published":true},"frontmatter":{"title":"Das neue Ministerkabinett","tags":["loosely-coupled","humour"],"date":"2010/03/10"}},"next":{"fields":{"slug":"/2010/03/19/rfb-getting-several-values-out-of-a-powershell-script","published":true},"frontmatter":{"title":"rfb: Getting several values out of a PowerShell script","tags":["dotnet","msbuild","own-software","tools"],"date":"2010/03/19"}}}}}