{"componentChunkName":"component---src-templates-article-template-js","path":"/2010/03/19/rfb-getting-several-values-out-of-a-powershell-script","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"rfb: Getting several values out of a PowerShell script\",\n  \"layout\": \"post\",\n  \"tags\": [\"dotnet\", \"msbuild\", \"own-software\", \"tools\"],\n  \"date\": \"2010-03-19T20:37:00.000Z\",\n  \"redirect_from\": \"/go/163/\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component '\" + name + \"' was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"The whole \\u201C\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/go/160\"\n  }), \"MSBuild without XML\"), \"\\u201C started with the FubuMVC project using ruby for building. It quickly became apparent that one major omission of MSBuild is the lack of ability of adding \\u201Cad-hoc\\u201D code to it. Which is why MSBuild was \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/go/162\"\n  }), \"married to PowerShell\"), \".\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"language-text\"\n  }), mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"gittag = `git describe --long`.chomp\\ngitnumberpart = /-(\\\\d+)-/.match(gittag)\\ngitnumber = gitnumberpart.nil? ? '0' : gitnumberpart[1]\\ncommit = (ENV[\\\"BUILD_VCS_NUMBER\\\"].nil? ? `git log -1 --pretty=format:%H` : ENV[\\\"BUILD_VCS_NUMBER\\\"])\"))), mdx(\"p\", null, \"of which \\u201Cgitnumber\\u201D and \\u201Ccommit\\u201D are used later on.\"), mdx(\"p\", null, \"Now, doing something like the above in PowerShell isn\\u2019t that difficult, but I didn\\u2019t know at first how to get two values back to MSBuild from a single script, until I remembered the following construct in PowerShell.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"language-text\"\n  }), mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"PS C:\\\\Users\\\\flq> $a = @{A=\\\"a\\\";B=\\\"b\\\"}\\nPS C:\\\\Users\\\\flq> $a.A\\na\\nPS C:\\\\Users\\\\flq> $a.B\\nb\\nPS C:\\\\Users\\\\flq>\"))), mdx(\"p\", null, \"It turns out that PowerShell constructs a Hashtable instance from the first line and then provides some syntax sugar to access the key-value pairs with a dot-notation. Armed with this knowledge I could teach rfb to support the following script: \"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"language-text\"\n  }), mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"Project \\\"Default\\\"\\n\\n  Target \\\"Default\\\"\\n    @gitInfo <= GetGitInfo -Capture:number,commit\\n    $gitnumber = %(gitInfo.number)\\n    $commit = %(gitInfo.commit)\\n    Message \\\"gitnumber $(gitnumber), commit $(commit)\\\"\\n\\n  PS:GetGitInfo <<END\\n    cd C:\\\\dotnet\\\\dev\\\\github\\\\rfb\\n    $gittag = git describe --long\\n    $gitnumberpart = [System.Text.RegularExpressions.Regex]::Match($gittag, \\\"\\\\.(\\\\d+)\\\").Groups[1].Value\\n    $commit = if ($env:BUILD_VCS_NUMBER -eq $null) { git log -1 --pretty=format:%H } else { $env:BUILD_VCS_NUMBER }\\n    Write-Host \\\"$gitnumberpart and $commit\\\"\\n    @{ number = $gitnumberpart; commit = $commit}\\n  END\"))), mdx(\"p\", null, \"Some people may see it as a hack to use an item group for getting a single line, however the item group has the notion of metadata which allows for a dot-notation to access several values, which makes it a nice container to retrieve numerous values from a single PowerShell script.\"));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"slug":"/2010/03/19/rfb-getting-several-values-out-of-a-powershell-script"},"frontmatter":{"date":"March 19, 2010","path":null,"title":"rfb: Getting several values out of a PowerShell script","tags":["dotnet","msbuild","own-software","tools"]}}},"pageContext":{"title":"rfb: Getting several values out of a PowerShell script","previous":{"fields":{"slug":"/2010/03/14/rfb-marrying-msbuild-and-powershell","published":true},"frontmatter":{"title":"rfb: Marrying MSBuild and PowerShell","tags":["dotnet","msbuild","tools","own-software"],"date":"2010/03/14"}},"next":{"fields":{"slug":"/2010/03/23/some-powershell-foo-playin-with-da-task-scheduler","published":true},"frontmatter":{"title":"Some PowerShell Foo...playin' with da Task Scheduler","tags":["tools"],"date":"2010/03/23"}}}}}