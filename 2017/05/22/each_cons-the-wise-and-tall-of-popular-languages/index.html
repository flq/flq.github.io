<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/app.a03716562d1e590f30ef.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{position:relative;margin:.5em 0;overflow:visible;padding:0}pre[class*=language-]>code{position:relative;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-size:3em 3em;background-origin:content-box;background-attachment:local}code[class*=language]{max-height:inherit;height:inherit;padding:0 1em;display:block;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{position:relative;padding:.2em;border-radius:.3em;color:#c92c2c;border:1px solid rgba(0,0,0,.1);display:inline;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{content:"";z-index:-2;display:block;position:absolute;bottom:.75em;left:.18em;width:40%;height:20%;max-height:13em;box-shadow:0 13px 8px #979797;-webkit-transform:rotate(-2deg);transform:rotate(-2deg)}:not(pre)>code[class*=language-]:after,pre[class*=language-]:after{right:.75em;left:auto;-webkit-transform:rotate(2deg);transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}.token.cr:before,.token.lf:before,.token.tab:not(:empty):before{color:#e0d7d1}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}</style><style data-href="/0.80b55132b2de845930a9.css">/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}.container{position:relative;max-width:1260px;margin:0 auto;padding:0 20px}.column,.columns,.container{width:100%;box-sizing:border-box}.column,.columns{float:left}@media (min-width:400px){.container{width:85%;padding:0}}@media (min-width:550px){.container{width:80%}.column,.columns{margin-left:4%}.column:first-child,.columns:first-child{margin-left:0}.one.column,.one.columns{width:4.66666666667%}.two.columns{width:13.3333333333%}.three.columns{width:22%}.four.columns{width:30.6666666667%}.five.columns{width:39.3333333333%}.six.columns{width:48%}.seven.columns{width:56.6666666667%}.eight.columns{width:65.3333333333%}.nine.columns{width:74%}.ten.columns{width:82.6666666667%}.eleven.columns{width:91.3333333333%}.twelve.columns{width:100%;margin-left:0}.one-third.column{width:30.6666666667%}.two-thirds.column{width:65.3333333333%}.one-half.column{width:48%}.offset-by-one.column,.offset-by-one.columns{margin-left:8.66666666667%}.offset-by-two.column,.offset-by-two.columns{margin-left:17.3333333333%}.offset-by-three.column,.offset-by-three.columns{margin-left:26%}.offset-by-four.column,.offset-by-four.columns{margin-left:34.6666666667%}.offset-by-five.column,.offset-by-five.columns{margin-left:43.3333333333%}.offset-by-six.column,.offset-by-six.columns{margin-left:52%}.offset-by-seven.column,.offset-by-seven.columns{margin-left:60.6666666667%}.offset-by-eight.column,.offset-by-eight.columns{margin-left:69.3333333333%}.offset-by-nine.column,.offset-by-nine.columns{margin-left:78%}.offset-by-ten.column,.offset-by-ten.columns{margin-left:86.6666666667%}.offset-by-eleven.column,.offset-by-eleven.columns{margin-left:95.3333333333%}.offset-by-one-third.column,.offset-by-one-third.columns{margin-left:34.6666666667%}.offset-by-two-thirds.column,.offset-by-two-thirds.columns{margin-left:69.3333333333%}.offset-by-one-half.column,.offset-by-one-half.columns{margin-left:52%}}html{font-size:62.5%}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;color:#222}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:2rem;font-weight:300}h1{font-size:4rem;line-height:1.2}h1,h2{letter-spacing:-.1rem}h2{font-size:3.6rem;line-height:1.25}h3{font-size:3rem;line-height:1.3;letter-spacing:-.1rem}h4{font-size:2.4rem;line-height:1.35;letter-spacing:-.08rem}h5{font-size:1.8rem;line-height:1.5;letter-spacing:-.05rem}h6{font-size:1.5rem;line-height:1.6;letter-spacing:0}@media (min-width:550px){h1{font-size:5rem}h2{font-size:4.2rem}h3{font-size:3.6rem}h4{font-size:3rem}h5{font-size:2.4rem}h6{font-size:1.5rem}}p{margin-top:0}a{color:#1eaedb}a:hover{color:#0fa0ce}.button,button,input[type=button],input[type=reset],input[type=submit]{display:inline-block;height:38px;padding:0 30px;color:#555;text-align:center;font-size:11px;font-weight:600;line-height:38px;letter-spacing:.1rem;text-transform:uppercase;text-decoration:none;white-space:nowrap;background-color:transparent;border-radius:4px;border:1px solid #bbb;cursor:pointer;box-sizing:border-box}.button:focus,.button:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{color:#333;border-color:#888;outline:0}.button.button-primary,button.button-primary,input[type=button].button-primary,input[type=reset].button-primary,input[type=submit].button-primary{color:#fff;background-color:#33c3f0;border-color:#33c3f0}.button.button-primary:focus,.button.button-primary:hover,button.button-primary:focus,button.button-primary:hover,input[type=button].button-primary:focus,input[type=button].button-primary:hover,input[type=reset].button-primary:focus,input[type=reset].button-primary:hover,input[type=submit].button-primary:focus,input[type=submit].button-primary:hover{color:#fff;background-color:#1eaedb;border-color:#1eaedb}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{height:38px;padding:6px 10px;background-color:#fff;border:1px solid #d1d1d1;border-radius:4px;box-shadow:none;box-sizing:border-box}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none}textarea{min-height:65px;padding-top:6px;padding-bottom:6px}input[type=email]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=url]:focus,select:focus,textarea:focus{border:1px solid #33c3f0;outline:0}label,legend{display:block;margin-bottom:.5rem;font-weight:600}fieldset{padding:0;border-width:0}input[type=checkbox],input[type=radio]{display:inline}label>.label-body{display:inline-block;margin-left:.5rem;font-weight:400}ul{list-style:circle inside}ol{list-style:decimal inside}ol,ul{padding-left:0;margin-top:0}ol ol,ol ul,ul ol,ul ul{margin:1.5rem 0 1.5rem 3rem;font-size:90%}li{margin-bottom:1rem}div.highlight{font-size:90%;white-space:nowrap;background:#f1f1f1;border:1px solid #e1e1e1;border-radius:4px;margin-bottom:2.5rem}code{padding:.2rem .5rem;margin:0 .2rem}pre>code{display:block;padding:1rem 1.5rem;white-space:pre}td,th{padding:12px 15px;text-align:left;border-bottom:1px solid #e1e1e1}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}.button,button{margin-bottom:1rem}fieldset,input,select,textarea{margin-bottom:1.5rem}blockquote,dl,figure,form,ol,p,pre,table,ul{margin-bottom:2.5rem}.u-full-width{width:100%;box-sizing:border-box}.u-max-full-width{max-width:100%;box-sizing:border-box}.u-pull-right{float:right}.u-pull-left{float:left}hr{margin-top:3rem;margin-bottom:3.5rem;border-width:0;border-top:1px solid #e1e1e1}.container:after,.row:after,.u-cf{content:"";display:table;clear:both}.highlight .hll{background-color:#ffc}.highlight .c{color:#999}.highlight .err{color:#a00;background-color:#faa}.highlight .k{color:#069}.highlight .o{color:#555}.highlight .cm{color:#09f;font-style:italic}.highlight .cp{color:#099}.highlight .c1,.highlight .cs{color:#999}.highlight .gd{background-color:#fcc;border:1px solid #c00}.highlight .ge{font-style:italic}.highlight .gr{color:red}.highlight .gh{color:#030}.highlight .gi{background-color:#cfc;border:1px solid #0c0}.highlight .go{color:#aaa}.highlight .gp{color:#009}.highlight .gu{color:#030}.highlight .gt{color:#9c6}.highlight .kc,.highlight .kd,.highlight .kn,.highlight .kp,.highlight .kr{color:#069}.highlight .kt{color:#078}.highlight .m{color:#f60}.highlight .s{color:#d44950}.highlight .na{color:#4f9fcf}.highlight .nb{color:#366}.highlight .nc{color:#0a8}.highlight .no{color:#360}.highlight .nd{color:#99f}.highlight .ni{color:#999}.highlight .ne{color:#c00}.highlight .nf{color:#c0f}.highlight .nl{color:#99f}.highlight .nn{color:#0cf}.highlight .nt{color:#2f6f9f}.highlight .nv{color:#033}.highlight .ow{color:#000}.highlight .w{color:#bbb}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#f60}.highlight .sb,.highlight .sc{color:#c30}.highlight .sd{color:#c30;font-style:italic}.highlight .s2,.highlight .se,.highlight .sh{color:#c30}.highlight .si{color:#a00}.highlight .sx{color:#c30}.highlight .sr{color:#3aa}.highlight .s1{color:#c30}.highlight .ss{color:#fc3}.highlight .bp{color:#366}.highlight .vc,.highlight .vg,.highlight .vi{color:#033}.highlight .il{color:#f60}.css .nt+.nt,.css .o,.css .o+.nt{color:#999}body{font-size:1.8em}kbd{padding:.1em;border-radius:3px;border:1px solid #ccc;color:#333;display:inline-block;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 2px #fff;background-color:#f7f7f7;text-shadow:0 1px 0 #fff}figcaption{text-align:center;font-style:italic;color:#777;display:block;margin-bottom:2em}.sidebar h1{font-size:2.4em}.sidebar__sitetitle{color:#af0000}.sidebar__twitter{display:none;margin-top:2rem}.footer__twitter{display:none}.footer__copyright{float:right;font-size:.7em}.right-padded{padding-right:2rem}@media (max-width:550px){.sidebar h1,.sidebar p{margin-bottom:.5rem}.sidebar{padding-bottom:1rem;margin-bottom:1rem;border-bottom:1px solid grey}.footer__twitter{display:inline-block}}@media (min-width:550px){.sidebar h1{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);text-align:right;margin-top:150px;margin-bottom:100px}.sidebar__twitter{display:block}.copyright{margin-top:40px}}.sidebar p{text-align:justify;font-size:.8em}.sidebar h1 a{text-decoration:none}nav a{display:block}.pagination{margin-top:20px}.center,.pagination{text-align:center}.expand{width:80%}.teaser{margin-bottom:70px}.teaser .date{display:block;margin-top:-20px;margin-bottom:20px;text-align:right}.teaser h3 a{text-decoration:none}.page-info{text-align:right;margin-bottom:40px}article iframe,article img{display:block;margin:20px auto;max-width:100%}article div.highlight,article iframe,article img{box-shadow:0 8px 16px 0 rgba(0,0,0,.2),0 6px 20px 0 rgba(0,0,0,.19)}article div.highlight{scroll-behavior:auto}blockquote{background:#f9f9f9;border-left:10px solid #ccc;padding:.5em 10px;quotes:"\201C" "\201D" "\2018" "\2019"}blockquote:before{color:#ccc;content:"\201D";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}div.seriestoc{background:#f9f9f9;border-left:10px solid #ccc;padding:.5em 10px;font-size:1em}div.seriestoc:before{color:#ccc;content:":";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}.blog-post__content>h3:first-of-type{text-align:right;border-radius:25px 25px 0 0;font-size:1.2em;background-color:#777;color:#fff;margin-bottom:0;padding:2px 20px 2px 0;font-style:italic}.blog-post__content>ol:first-of-type{list-style-type:upper-roman;background:#eff;border:1px solid #777;border-radius:0 0 25px 25px;margin-top:0;list-style-position:outside;padding:10px 10px 10px 45px}.blog-post__footer{margin:1rem 0 2rem}.article-tags{margin-left:.3rem}.article-tags--tag{margin-left:.5rem}.article-tags--tag:after{margin-left:.5rem;content:"|"}.article-tags--tag:last-child:after{content:""}.blog-post__pagination{display:flex;justify-content:space-between;margin-bottom:2rem}.blog-post__pagination--previous{text-decoration:none;margin:0 1rem}.blog-post__pagination--previous:hover{text-decoration:underline}.blog-post__pagination--previous:before{content:"\21A4   "}.blog-post__pagination--next:after{content:" \21A6"}.blog-post__pagination--next{text-decoration:none;margin:0 1rem}.blog-post__pagination--next:hover{text-decoration:underline}</style><meta name="generator" content="Gatsby 2.0.91"/><title data-react-helmet="true">each_cons - the wise and tall of popular languages</title><link data-react-helmet="true" href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css"/><meta data-react-helmet="true" name="description" content="Content from Frank Quednau about dev and fields of interest."/><meta data-react-helmet="true" name="keywords" content="programming, ruby, csharp, fsharp, haskell"/><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-87673c31a5b37b5e6556b63e1081ebbc.css"/><link rel="alternate" type="application/rss+xml" title="Realfiction RSS" href="/atom.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/component---src-templates-article-template-js-0d50b129641477731f1b.js"/><link as="script" rel="preload" href="/0-3fa69c1a4f2a06128c7c.js"/><link as="script" rel="preload" href="/1-b800af6eeb94a4b43009.js"/><link as="script" rel="preload" href="/app-7003a227919f11333437.js"/><link as="script" rel="preload" href="/webpack-runtime-4ee75dd532da43586c9c.js"/><link as="fetch" rel="preload" href="/static/d/631/path---2017-05-22-each-cons-the-wise-and-tall-of-popular-languages-224-afb-r54XQS3hziTq6QgKTl6MpEt0jw.json" crossOrigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="container"><div class="row"><div class="two columns right-padded"><div class="sidebar"><h1><a class="sidebar__sitetitle" href="/">Realfiction</a></h1><p>Content from Frank Quednau about dev and fields of interest.</p><nav><a href="/tags">Tags</a></nav><div class="sidebar__twitter"><a href="https://twitter.com/fquednau?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-show-count="false" data-show-screen-name="false">Follow @fquednau</a></div></div></div><div class="nine columns"><article><h1>each_cons - the wise and tall of popular languages</h1><div class="page-info"><span>May 22, 2017</span> in<span class="article-tags"><a class="article-tags--tag" href="/tags/programming">programming</a><a class="article-tags--tag" href="/tags/ruby">ruby</a><a class="article-tags--tag" href="/tags/csharp">csharp</a><a class="article-tags--tag" href="/tags/fsharp">fsharp</a><a class="article-tags--tag" href="/tags/haskell">haskell</a></span></div><div class="blog-post__content"><p>A few days ago, Michael Feathers tweeted this:</p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">The fact that many simple correct Ruby programs become ridiculously complex when translated to other languages means something.</p>&mdash; Michael Feathers (@mfeathers) <a href="https://twitter.com/mfeathers/status/864122686695460866">May 15, 2017</a></blockquote>
<p>Now, I am not a complete <a href="/tags/ruby">stranger to ruby</a>, which is why this statement resonated with me, and upon requesting an example, Michael came up with this:</p>
<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/fquednau">@fquednau</a> The simple ones are interesting. Try this in C#: ([0] + arr).each_cons(2).count {|x,y| x == 0 &amp;&amp; y == 1 }</p>&mdash; Michael Feathers (@mfeathers) <a href="https://twitter.com/mfeathers/status/864222881538072578">May 15, 2017</a></blockquote>
<p>or</p>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each_cons</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count <span class="token punctuation">{</span><span class="token operator">|</span>x<span class="token punctuation">,</span>y<span class="token operator">|</span> x <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p><a href="https://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-each_cons">each_cons</a> is a function that provides consecutive elements
of a given list. E.g.
<code class="language-text">[0,1,2,3].each_cons(3).each { |x,y,z| puts &quot;#{x},#{y},#{z}&quot; }</code>
It can be useful for obtaining info about the local structure
of a list. Think derivatives, rates of change, etc. and probably
a host of other things.</p>
</blockquote>
<p>This does indeed show off ruby's expresiveness quite nicely:</p>
<ul>
<li>A simple syntax to concatenate lists</li>
<li>A rich set of libraries for manipulation of things (I am referring to the <em>each\</em>cons_)</li>
<li>The syntax of ruby's yields and blocks, which have been used so many times as the syntactical basis for DSLs</li>
</ul>
<p>The fact that the parameter influences how many items will be yielded into
your block reminds us why all of us like to write Javascript once in a while.</p>
<p><strong>What about other languages then?</strong></p>
<h2>F#</h2>
<p>Let's look at the code which performs (almost) the same job:</p>
<div class="gatsby-highlight" data-language="fsharp"><pre class="language-fsharp"><code class="language-fsharp">seq <span class="token punctuation">{</span> <span class="token keyword">yield</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">yield!</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token number">.4</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span><span class="token operator">></span> Seq<span class="token punctuation">.</span>pairwise 
  <span class="token operator">|</span><span class="token operator">></span> Seq<span class="token punctuation">.</span>filter <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token operator">|</span><span class="token operator">></span> Seq<span class="token punctuation">.</span>length</code></pre></div>
<p>It is pretty compact and readable, but even though some things look
similar, they actually use completely different mechanics of the
language</p>
<ul>
<li>The first line is a <a href="https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/sequences">computational expression to generate sequences</a> which provides
us with a pretty syntax for concatenating elements and lists of elements</li>
<li>The <em>pairwise</em> is the closest we get to <em>each\</em>cons_</li>
<li>The <em>length</em> does not have a version where we can provide a filter condition, so we
need to specify the filter beforehand.</li>
<li>The <em>pairwise</em> method provides a tuple which is then pattern matched into two arguments in the
lambda to <em>filter</em>.</li>
</ul>
<p>Of note is that <em>pairwise</em> will provide exactly 2 consecutive elements of a list, it
does not allow a parameter like the ruby version. This makes sense, since F# is statically typed.
If you wanted a version that provides 3 consecutive elements, you would have to write a method
yourself that yields an element of type <strong>(a,a,a)</strong>.</p>
<h2>C#</h2>
<p>To actually achieve the same level of expressiveness we need to put some work into this:</p>
<p><img src="/assets/csharp_cons.jpg"></p>
<p>With those two additional extension methods we can now write</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token number">0.</span><span class="token function">ToEnumerable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Windowed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>t <span class="token operator">=</span><span class="token operator">></span> t<span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span>y <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>While tuples are now available in c#, you cannot deconstruct them like you can do in most other
functional languages or even in ES2016
(which has actually gone to great lengths to make deconstruction a dependable feature).</p>
<p>While I can kind of forgive a missing <em>each\</em>cons<em>-like BCL method, I write the _ToEnumerable</em> again in almost every project. I mean, that method is the damned <a href="https://en.wikipedia.org/wiki/Monad_(functional_programming)#Overview">unary return operation</a>!</p>
<h2>Kotlin</h2>
<p>Xavier Lepaul chimed in with a view on what Kotlin is up to with respect to the challenge:</p>
<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/mfeathers">@mfeathers</a> <a href="https://twitter.com/fquednau">@fquednau</a> Kotlin is almost there (with <a href="https://t.co/b2TpoX5LqA">https://t.co/b2TpoX5LqA</a>)<br>(listOf(0) + arr).windowed(2).count {(x,y) -&gt; x == 0 &amp;&amp; y == 1}</p>&mdash; Xavier Lepaul (@xlepaul) <a href="https://twitter.com/xlepaul/status/864404258476752896">May 16, 2017</a></blockquote>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">windowed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token operator">-></span> x <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">}</span></code></pre></div>
<p>This doesn't fall very short of the ruby example, however, the <em>windowed</em> is not available yet in
Kotlin 1.1 - What I particularly liked is that even though the type signature of <em>windowed</em> is</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> Iterable<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">.</span><span class="token function">windowed</span><span class="token punctuation">(</span>size<span class="token operator">:</span> Int<span class="token punctuation">,</span> step<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">></span></code></pre></div>
<p>i.e. returning a list of lists, one can still deconstruct the list into the x and y you can
see in the lambda provided to <em>count</em>. This works because the deconstruction in kotlin simply
starts working when the deconstructed object provides methods named <em>component1</em> down to
<em>componentN</em>. A quick look at Kotlin's list type...</p>
<p><img src="/assets/kotlin_destructure.png"></p>
<p>Kudos to the Kotlin team which make a language that feels functional with strategies that are
very different to a "real" functional language. I have been an outsider to the JVM most of my
time, but when you get to know Java and Kotlin I really cannot fathom what exactly would make you
stick to Java.</p>
<h2>Type safety vs elegance?</h2>
<p>In order for ruby and Kotlin to shine in this example, both pay up by allowing misunderstandings
in API use to surface only at runtime. Note that in both languages the compiler will happily allow
you to capture more or less output than <em>each\</em>cons<em>/</em>windowed_ actually provides. This seems to be
the price you need to pay for such an API, since the output <em>"type"</em> is determined by the argument to the windowing function. Now if there was a language where types
could be determined programmatically...</p>
<h2>Idris</h2>
<p><a href="http://docs.idris-lang.org">Idris</a> is a programming language which is close in spirit to Haskell but adds the capability
to define <em>dependent types</em>. </p>
<blockquote>
<p>Disclaimer: I have never worked with Idris before, I just had the vague idea that dependent
types could be what I was looking for in this moment. Most of the things in Idris continue
to be outside my grasp. Many, many thanks go out to <strong>Anton Trunov</strong> who
<a href="http://stackoverflow.com/questions/44078891/how-do-i-evaluate-this-recursive-function-in-idris-interactive">answered</a> my stackoverflow <a href="http://stackoverflow.com/questions/44079181/idris-vect-fromlist-usage-with-generated-list">questions</a>.</p>
</blockquote>
<p>In this language, we can define the following type signature for a method:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">window</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">:</span> <span class="token constant">Nat</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">List</span> <span class="token hvariable">a</span> <span class="token operator">-></span> <span class="token constant">List</span> <span class="token punctuation">(</span><span class="token constant">Vect</span> <span class="token hvariable">n</span> <span class="token hvariable">a</span><span class="token punctuation">)</span></code></pre></div>
<p>This describes a method that takes a natural number <strong>n</strong>,
and a list containing things with type <strong>a</strong> and then returns a list containing vectors of length <strong>n</strong>. <strong>n</strong> has now become part of the type definition for <strong>Vect</strong>. With much help
(I couldn't see how to make the leap from the variable length <strong>List a</strong> to the type <strong>Vect n a</strong>),
this is then one possible implementation of <em>windowed</em> in Idris: </p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">total</span>
<span class="token hvariable">takeExact</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">:</span> <span class="token constant">Nat</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token hvariable">xs</span> <span class="token operator">:</span> <span class="token constant">List</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">Maybe</span> <span class="token punctuation">(</span><span class="token constant">Vect</span> <span class="token hvariable">n</span> <span class="token hvariable">a</span><span class="token punctuation">)</span>
<span class="token hvariable">takeExact</span> <span class="token constant">Z</span> <span class="token hvariable">xs</span> <span class="token operator">=</span> <span class="token constant">Just</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token hvariable">takeExact</span> <span class="token punctuation">(</span><span class="token constant">S</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Nothing</span>
<span class="token hvariable">takeExact</span> <span class="token punctuation">(</span><span class="token constant">S</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">::</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span> <span class="token hvariable">with</span> <span class="token punctuation">(</span><span class="token hvariable">takeExact</span> <span class="token hvariable">n</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span>
  <span class="token hvariable">takeExact</span> <span class="token punctuation">(</span><span class="token constant">S</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">::</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">Nothing</span> <span class="token operator">=</span> <span class="token constant">Nothing</span>
  <span class="token hvariable">takeExact</span> <span class="token punctuation">(</span><span class="token constant">S</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">::</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">Just</span> <span class="token hvariable">v</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">Just</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">::</span> <span class="token hvariable">v</span><span class="token punctuation">)</span>


<span class="token hvariable">total</span>
<span class="token hvariable">window</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">:</span> <span class="token constant">Nat</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">List</span> <span class="token hvariable">a</span> <span class="token operator">-></span> <span class="token constant">List</span> <span class="token punctuation">(</span><span class="token constant">Vect</span> <span class="token hvariable">n</span> <span class="token hvariable">a</span><span class="token punctuation">)</span>
<span class="token hvariable">window</span> <span class="token hvariable">n</span> <span class="token hvariable">xs</span> <span class="token hvariable">with</span> <span class="token punctuation">(</span><span class="token hvariable">takeExact</span> <span class="token hvariable">n</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span>
  <span class="token hvariable">window</span> <span class="token hvariable">n</span> <span class="token hvariable">xs</span> <span class="token operator">|</span> <span class="token constant">Nothing</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token hvariable">window</span> <span class="token hvariable">n</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">Just</span> <span class="token hvariable">ys</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token hvariable">window</span> <span class="token hvariable">n</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">::</span> <span class="token hvariable">xs</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">Just</span> <span class="token hvariable">ys</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">ys</span> <span class="token operator">::</span> <span class="token hvariable">window</span> <span class="token hvariable">n</span> <span class="token hvariable">xs</span></code></pre></div>
<blockquote>
<p><em>total</em> tells the Idris compiler to check the method whether it is indeed total as far as
Idris is capable to tell. Total means that this method is guaranteed to return for whatever
input that is provided. <strong>Z</strong> and <strong>S</strong> are types representing <strong>Zero</strong>
and <strong>Successor</strong> within the Natural number type.</p>
</blockquote>
<p>Now we can use the window function to write down the example provided.</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token comment">--with</span>
<span class="token hvariable">condition</span> <span class="token operator">:</span> <span class="token constant">Vect</span> <span class="token number">2</span> <span class="token constant">Integer</span> <span class="token operator">-></span> <span class="token constant">Bool</span>
<span class="token hvariable">condition</span> <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token hvariable">y</span> <span class="token operator">==</span> <span class="token number">1</span>

<span class="token operator">*</span><span class="token hvariable">hello</span><span class="token operator">></span> <span class="token builtin">length</span> <span class="token operator">$</span> <span class="token builtin">filter</span> <span class="token hvariable">condition</span> <span class="token punctuation">(</span><span class="token hvariable">window</span> <span class="token number">2</span> <span class="token operator">$</span> <span class="token number">0</span><span class="token operator">::</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token number">1</span> <span class="token operator">:</span> <span class="token constant">Nat</span></code></pre></div>
<p>It is also pretty compact, with the <em>little</em> difference that the filter function provided must
deconstruct a Vector of type <strong>Vect 2 Integer</strong>, based on the arguments to the <em>window</em> function. That is, in your function you are forced to take the vector as a whole or deconstruct to exactly
the right size that is provided.</p>
<p>Why is all this interesting? Because it is sometimes plain <em>fun</em> to compare different programming
languages. They present to you different ways of thinking, different ways to express your intentions. One common theme is that conciseness comes when you get close to functional programming idioms. Also, before this post I didn't think that you could actually expand upon the
Haskell type system, but you can. Alas, we also have to recognize the great popularity of languages like ruby. Reasoning with types requires much practice, but help you squash bugs before you even get to the runtime. Languages like javascript and ruby reward you quickly when you get your act together, but depend on decent documentation to get API usage right.</p>
<p>Hence, ruby is indeed expressive, but quite a few popular languages have learned to recreate that expressiveness with the possibilities that their respective runtimes provide.</p></div><div class="blog-post__footer"><a href="https://mobile.twitter.com/search?q=https%3A%2F%2Frealfiction.net%2F2017/05/22/each_cons-the-wise-and-tall-of-popular-languages" target="_blank" rel="noopener noreferrer">Discuss on Twitter ⇲</a></div><div class="blog-post__pagination"><a class="blog-post__pagination--previous" href="/2017/05/15/rant-on-the-importance-of-education">Rant on the importance of education</a><a class="blog-post__pagination--next" href="/2017/06/24/eleven-year-old-svg-engine-reposted">eleven year old svg engine, reposted</a></div></article></div></div><div class="row"><div class="footer__twitter"><a href="https://twitter.com/fquednau?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-show-count="false" data-show-screen-name="false">Follow @fquednau</a> </div><p class="footer__copyright">© Frank Quednau <!-- -->2019</p></div></div></div></div><script>
  window.excludeGAPaths=[/^(?:\/404)$/];
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1812710-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-article-template-js","jsonName":"2017-05-22-each-cons-the-wise-and-tall-of-popular-languages-224","path":"/2017/05/22/each_cons-the-wise-and-tall-of-popular-languages"};window.dataPath="631/path---2017-05-22-each-cons-the-wise-and-tall-of-popular-languages-224-afb-r54XQS3hziTq6QgKTl6MpEt0jw";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.a03716562d1e590f30ef.css","/app-7003a227919f11333437.js"],"component---src-templates-article-template-js":["/component---src-templates-article-template-js-0d50b129641477731f1b.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-827eb0660badd62ebbc1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-7de7581acfdeae5a1ab6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6ecdce646b7a717ffa67.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-bad0e5b91c4d33cf52ba.js"],"pages-manifest":["/pages-manifest-ecca0337756353396ecb.js"]};/*]]>*/</script><script src="/webpack-runtime-4ee75dd532da43586c9c.js" async=""></script><script src="/app-7003a227919f11333437.js" async=""></script><script src="/1-b800af6eeb94a4b43009.js" async=""></script><script src="/0-3fa69c1a4f2a06128c7c.js" async=""></script><script src="/component---src-templates-article-template-js-0d50b129641477731f1b.js" async=""></script></body></html>