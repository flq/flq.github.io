<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6708a7212b135e4abae1.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}:root{--linkColorMain:#af0000;--linkColorMainContrast:#c6f8ff;--linkColor:#1eaedb;--linkHoverHighlight:#fff 0px 0px 5px,#7791b3 0px 0px 10px;--background:#fff;--sidePadding:0.75rem;--topShadow:0px 5px 7px 0px rgba(0,0,0,0.55);--lightSeparator:1px solid #d3d3d3;--standardShadow:0 8px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;padding:0 var(--sidePadding) 0 var(--sidePadding)}a{color:var(--linkColor)}figcaption{text-align:center;font-style:italic;color:#777;display:block;margin-bottom:2em}img{display:block;margin:20px auto;max-width:100%;box-shadow:var(--standardShadow)}blockquote{background:#f9f9f9;border-left:10px solid #ccc;padding:.5rem 10px;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:"\201D";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}pre[class*=language-]{font-size:1rem;box-shadow:var(--standardShadow)}a{-webkit-text-decoration-style:dotted;text-decoration-style:dotted}h1{font-size:2.1rem}h1,h2{line-height:1.2}h2{font-size:1.7rem}h3{line-height:1.2;letter-spacing:.05rem}h3,h4{font-size:1.5rem}h4{font-weight:lighter;font-style:italic}@media (min-width:768px){h1{font-size:2.5rem}h1,h2{line-height:1.3}h2{font-size:2rem}h3{line-height:1.1}h3,h4{font-size:1.7rem}}.layout-module--layout--3NElS{display:flex;flex-direction:column;align-items:center}.layout-module--main--1XJsu{padding:5rem 0 1rem;width:100%}@media (min-width:768px){.layout-module--main--1XJsu{width:90%}}@media (min-width:1200px){.layout-module--main--1XJsu{width:70%}}@media (min-width:2000px){.layout-module--main--1XJsu{width:1060px}}.SiteHeader-module--siteNav--3VakG{display:flex;align-items:stretch;justify-content:center;padding:.5rem var(--sidePadding);box-shadow:var(--topShadow);background-color:var(--background);z-index:10;position:fixed;top:0;right:0;left:0}.SiteHeader-module--main--uZpGc{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.SiteHeader-module--siteHeader--3gDoz{font-family:Lora,serif;font-style:italic;letter-spacing:.01rem;text-shadow:2px 1px 1px #999;margin:0 1rem 0 0;font-size:2.2rem}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--siteLink--1QNau{text-decoration:none;display:inline-block}.SiteHeader-module--mainLink---Exlm:hover,.SiteHeader-module--siteLink--1QNau:hover{text-decoration:underline}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--mainLink---Exlm:visited,.SiteHeader-module--siteLink--1QNau,.SiteHeader-module--siteLink--1QNau:visited{color:var(--linkColorMain)}.SiteHeader-module--siteLink--1QNau:not(:first-child):before{content:" | ";color:#000;margin:0 .25rem;text-decoration:none;display:inline-block}@media (min-width:768px){.SiteHeader-module--main--uZpGc{width:90%}}@media (min-width:1200px){.SiteHeader-module--main--uZpGc{width:70%}}@media (min-width:2000px){.SiteHeader-module--main--uZpGc{width:1060px}}.Footer-module--main--1QC0I{width:100%;display:flex;flex-direction:row;padding-top:.5rem;margin-bottom:2rem;justify-content:center;align-items:center;font-size:1rem;border-top:var(--lightSeparator)}.Footer-module--main--1QC0I img{margin:.25rem;box-shadow:none}.Footer-module--main--1QC0I p{margin:.25rem}@media (min-width:768px){.Footer-module--main--1QC0I{width:90%}}@media (min-width:1200px){.Footer-module--main--1QC0I{width:70%}}@media (min-width:2000px){.Footer-module--main--1QC0I{width:55%}}.tags-module--columnList--2IU2r{display:grid;list-style:circle inside;grid-auto-flow:row;grid-template-columns:repeat(auto-fill,300px);max-width:100%;font-size:1.2rem}.tags-module--columnList--2IU2r a{text-decoration:none}.tags-module--columnList--2IU2r a:hover{text-decoration:underline}.Tag-module--tags--3UNk1{margin-top:.5rem}.Tag-module--tag--3otWA{background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;font-size:1.1rem;margin-top:0;padding:.25rem}.Tag-module--tag--3otWA,.Tag-module--tagOuter--27OmX{border-top-right-radius:10px;border-bottom-right-radius:10px;border-top-left-radius:5px;border-bottom-left-radius:5px}.Tag-module--tagOuter--27OmX{display:inline-flex;margin:0 .5rem .5rem 0;padding:0;line-height:1.1rem;box-shadow:5px 5px 8px -8px rgba(0,0,0,.91)}.Tag-module--tagOuter--27OmX:hover{text-shadow:var(--linkHoverHighlight)}.Tag-module--tag--3otWA:after{margin-left:.75rem;font-size:1.5rem;vertical-align:middle;content:"•"}.YouTubeEmbed-module--frame--JPpxk{display:block;margin:20px auto;width:516px;height:315px;max-width:100%;box-shadow:var(--standardShadow)}.Info-module--infoContainer--1O0oR,.Tweet-module--tweet--1nwF8{display:flex;justify-content:center}.Info-module--info--1Qfs3{position:relative;background:#c6f8ff;border-left:10px solid var(--linkColor);margin-bottom:2.5rem;box-shadow:var(--standardShadow);padding:1rem .25rem 1rem 60px;quotes:"\201C""\201D""\2018""\2019"}.Info-module--info--1Qfs3>p{margin:0}div.Info-module--info--1Qfs3:before{position:absolute;left:5px;color:var(--linkColor);content:"\24D8";font-size:1.8em;font-family:helvetica;margin-right:.25em;vertical-align:-.2em}.DateDisplay-module--dateContainer--1trkw{align-self:flex-start;display:inline-grid;grid-template-columns:0 auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.DateDisplay-module--month--2KOka{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.DateDisplay-module--date--oZxQz{display:flex;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch;justify-content:center;align-items:center}.DateDisplay-module--year--2577t{display:block;visibility:hidden;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.DateDisplay-module--excerpt--ac7UJ{font-size:1.4rem;margin:.25rem}@media (min-width:500px){.DateDisplay-module--dateContainer--1trkw{grid-template-columns:1.5rem 3rem}.DateDisplay-module--year--2577t{visibility:visible}}.postExcerpt-module--article--1YC-H{margin-bottom:3rem}.postExcerpt-module--article--1YC-H:last-of-type{margin-bottom:0}.postExcerpt-module--headerContainer--hcRy6{display:flex;flex-direction:row;align-items:center}.postExcerpt-module--header--1LVL4{font-size:1.7rem;line-height:2rem;margin:0 0 0 .5rem}.postExcerpt-module--header--1LVL4 a{text-decoration:none}.postExcerpt-module--header--1LVL4 a:hover{text-decoration:underline}.postExcerpt-module--dateContainer--3lfoy{align-self:flex-start;display:inline-grid;grid-template-columns:auto auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.postExcerpt-module--month--59SAH{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.postExcerpt-module--date--2LGbD{display:block;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch}.postExcerpt-module--year--w1z16{display:block;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.postExcerpt-module--excerpt--2vlk7{font-size:1.4rem;margin:.25rem}.TopicToc-module--container--iTCNh{border-radius:25px;background:#f9f9f9;box-shadow:var(--standardShadow)}.TopicToc-module--header--23y04{text-align:right;border-top-left-radius:25px;border-top-right-radius:25px;font-size:1.2em;background-color:#777;color:#fff;margin-bottom:0;padding:2px 20px 2px 0;font-style:italic}.TopicToc-module--list--d3sjU{list-style-type:upper-roman;margin:1rem;padding-bottom:1rem;list-style-position:outside}.Discussion-module--alpha--2wwoE{margin-right:20%}.Discussion-module--beta--280lX{margin-left:20%}.Discussion-module--alpha--2wwoE:before{content:"η: «"}.Discussion-module--alpha--2wwoE:after,.Discussion-module--beta--280lX:after{content:"»"}.Discussion-module--beta--280lX:before{content:"μ: «"}.articleTemplate-module--header--354F0{display:grid;grid-template-rows:auto auto;grid-template-columns:auto auto;column-gap:.25rem;font-size:1.2rem;margin-bottom:2rem}.articleTemplate-module--date--2zr35{grid-column:2;grid-row:1;justify-self:end}.articleTemplate-module--h1--2QcXm{grid-row:1;grid-column:1;margin:0}.articleTemplate-module--tags--1YeyG{grid-row:2;grid-column:1/span 2}.PreviousAndNext-module--navigation--123UK{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(2,auto);border:1px solid var(--linkColor);border-radius:5px}.PreviousAndNext-module--link--iq7Ea{display:flex;align-items:center;justify-content:center;padding:.25rem 1.5rem;background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;align-self:stretch;margin:.25rem;border-radius:5px}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1;grid-row:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:2;grid-row:1}.PreviousAndNext-module--disabled--oYrWw{opacity:.2}.PreviousAndNext-module--link--iq7Ea:hover{text-shadow:var(--linkHoverHighlight)}.PreviousAndNext-module--title--3-yUO{font-size:1rem;padding:0 .5rem}.PreviousAndNext-module--border--dT-B7{border-left:1px dashed var(--linkColor)}@media (min-width:768px){.PreviousAndNext-module--navigation--123UK{grid-template-columns:auto repeat(2,1fr) auto;grid-template-rows:auto}.PreviousAndNext-module--link--iq7Ea{margin:0;border-radius:0}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:4}.PreviousAndNext-module--border--dT-B7{border-left:1px solid var(--linkColor)}}.tagTemplate-module--articleList--1XmWn{font-size:1.2rem;list-style:circle inside}.tagTemplate-module--articleList--1XmWn a,.tagTemplate-module--articleListHeader--3yVYd a{text-decoration:none}.tagTemplate-module--articleList--1XmWn a:hover,.tagTemplate-module--articleListHeader--3yVYd a:hover{text-decoration:underline}</style><meta name="generator" content="Gatsby 3.4.2"/><title data-react-helmet="true">FunSpIns - Collisions, the dead, and a (not so) grateful ending.</title><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"/><link data-react-helmet="true" href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet"/><link data-react-helmet="true" href="//fonts.googleapis.com/css2?family=Lora:ital,wght@1,500&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Content from Frank Quednau about dev and fields of interest."/><meta data-react-helmet="true" name="keywords" content="programming, haskell"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="FunSpIns - Collisions, the dead, and a (not so) grateful ending."/><meta data-react-helmet="true" name="twitter:site:id" content="fquednau"/><meta data-react-helmet="true" name="twitter:description" content="Inspired by Rob Ashton&#x27;s series &quot; Learn functional programming with me &quot; Without further ado, let&#x27;s have a look at arguably the most important…"/><meta data-react-helmet="true" name="twitter:image" content="https://realfiction.net/icons/icon-72x72.png"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Realfiction RSS" href="/atom.xml"/><link rel="icon" href="/favicon-32x32.png?v=4ebdacb62247bfbfe92c555d6c833c53" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-c0e9b35e2527e2b6d994.js"/><link as="script" rel="preload" href="/framework-75034fa8e3a9e81ff051.js"/><link as="script" rel="preload" href="/app-18c5db79b52bec877cad.js"/><link as="script" rel="preload" href="/commons-5ffe1f2bcdc9b9fa2a3d.js"/><link as="script" rel="preload" href="/component---src-templates-article-template-js-f04abf4d737cf958b9a2.js"/><link as="fetch" rel="preload" href="/page-data/2013/09/26/funspins-collisions-the-dead-and-a-not-so-grateful-ending/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/256249292.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2581731408.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--layout--3NElS"><nav class="SiteHeader-module--siteNav--3VakG"><div class="SiteHeader-module--main--uZpGc"><h1 class="SiteHeader-module--siteHeader--3gDoz"><a class="SiteHeader-module--mainLink---Exlm" href="/">Realfiction</a></h1><div><a class="SiteHeader-module--siteLink--1QNau" href="/tags">Tags</a><a class="SiteHeader-module--siteLink--1QNau" href="/about">About</a></div></div></nav><main class="layout-module--main--1XJsu"><article><header class="articleTemplate-module--header--354F0"><time class="DateDisplay-module--dateContainer--1trkw articleTemplate-module--date--2zr35" dateTime="2013-09-26"><span class="DateDisplay-module--month--2KOka">Sep</span><span class="DateDisplay-module--date--oZxQz">26</span><span class="DateDisplay-module--year--2577t">2013</span></time><h1 class="articleTemplate-module--h1--2QcXm">FunSpIns - Collisions, the dead, and a (not so) grateful ending.</h1><nav class="Tag-module--tags--3UNk1 articleTemplate-module--tags--1YeyG"><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/programming">programming</a></div><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/haskell">haskell</a></div></nav></header><nav class="TopicToc-module--container--iTCNh"><h3 class="TopicToc-module--header--23y04">Functional space-invaders series</h3><ol class="TopicToc-module--list--d3sjU"><li><a href="/2013/09/17/funspins-a-recap-of-rob-ashtons-lessons-das-intro">FunSpIns - a recap of Rob Ashton&#x27;s lessons - Das Intro</a></li><li><a href="/2013/09/18/funspins-drawing-a-rectangle">FunSpIns - Drawing a Rectangle</a></li><li><a href="/2013/09/19/funspins-moving-a-rectangle">FunSpIns - Moving a Rectangle</a></li><li><a href="/2013/09/20/funspins-no-attributes-no-vectors-a-tiny-workflow-and-more-squares">FunSpIns - No attributes, No vectors, A tiny Workflow and more squares</a></li><li><a href="/2013/09/23/funspins-state-the-world-the-loop">FunSpIns - State, the World, the Loop</a></li><li><a href="/2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter">FunSpIns - The hero must move, the enemies must move smarter.</a></li><li><a href="/2013/09/25/funspins-the-hero-shoots">FunSpIns - The hero shoots.</a></li><li><span>FunSpIns - Collisions, the dead, and a (not so) grateful ending.</span></li></ol></nav><blockquote><p>Inspired by Rob Ashton&#x27;s series &quot;<a href="http://codeofrob.com/entries/learn-functional-programming-with-me---adding-collision-detection-to-the-game.html">Learn functional programming with me</a>&quot;</p></blockquote><p>Without further ado, let&#x27;s have a look at arguably the most important function of the game...<strong>kill</strong>!</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">kill</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token hvariable">kill</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token hvariable">remainingShots</span> <span class="token hvariable">dead</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">remainingShots</span><span class="token punctuation">,</span><span class="token hvariable">dead</span><span class="token punctuation">)</span>
<span class="token hvariable">kill</span> <span class="token hvariable">_</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token hvariable">dead</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token hvariable">dead</span><span class="token punctuation">)</span>
<span class="token hvariable">kill</span> <span class="token punctuation">(</span><span class="token hvariable">e</span><span class="token operator">:</span><span class="token hvariable">enemies</span><span class="token punctuation">)</span> <span class="token hvariable">shots</span> <span class="token hvariable">dead</span> <span class="token operator">=</span>
	<span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token hvariable">find</span> <span class="token punctuation">(</span><span class="token hvariable">intersect</span> <span class="token hvariable">e</span><span class="token punctuation">)</span> <span class="token hvariable">shots</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
		<span class="token constant">Just</span> <span class="token hvariable">shot</span> <span class="token operator">-&gt;</span> <span class="token hvariable">kill</span> <span class="token hvariable">enemies</span> <span class="token punctuation">(</span><span class="token hvariable">shots</span> <span class="token operator">\\</span> <span class="token punctuation">[</span><span class="token hvariable">shot</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">dead</span><span class="token operator">++</span><span class="token punctuation">[</span><span class="token hvariable">e</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token constant">Nothing</span> <span class="token operator">-&gt;</span> <span class="token hvariable">kill</span> <span class="token hvariable">enemies</span> <span class="token hvariable">shots</span> <span class="token hvariable">dead</span>
<span class="token hvariable">intersect</span> <span class="token hvariable">wi</span> <span class="token hvariable">wi</span>&#x27; <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">getRect</span> <span class="token hvariable">wi</span><span class="token punctuation">)</span> <span class="token operator">#</span> <span class="token punctuation">(</span><span class="token hvariable">getRect</span> <span class="token hvariable">wi</span>&#x27;<span class="token punctuation">)</span>
	<span class="token keyword">where</span> 
		<span class="token punctuation">(</span><span class="token operator">#</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Rect</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span> <span class="token hvariable">w</span> <span class="token hvariable">h</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Rect</span> <span class="token hvariable">x</span>&#x27; <span class="token hvariable">y</span>&#x27; <span class="token hvariable">w</span>&#x27; <span class="token hvariable">h</span>&#x27;<span class="token punctuation">)</span> <span class="token operator">=</span> 
			<span class="token punctuation">(</span><span class="token hvariable">y</span> <span class="token operator">+</span> <span class="token hvariable">h</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token hvariable">y</span>&#x27; <span class="token operator">&amp;&amp;</span> <span class="token hvariable">y</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token hvariable">y</span>&#x27; <span class="token operator">+</span> <span class="token hvariable">h</span>&#x27;<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token hvariable">x</span>&#x27; <span class="token operator">&amp;&amp;</span> <span class="token hvariable">x</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>&#x27; <span class="token operator">+</span> <span class="token hvariable">w</span>&#x27;<span class="token punctuation">)</span></code></pre></div><p>It takes in all enemies, all shots and returns the shots that remain and those who died.
On each (recursive) iteration it takes an enemy and tries to figure out if it collides with any shot <em>(find (intersect e) shots)</em>. The intersection code is shamelessly copied from a <a href="https://github.com/snkkid/LazyFooHaskell/blob/master/lesson17/lesson17.hs#L62">SDL tutorial transcribed to Haskell</a>. If a collision is detected, the shot that hit gets removed from the list of shots, and the list of the dead increases by one. Otherwise we enter the next iteration unchanged.</p><p>This implementation is obviously <em>far from perfect</em> performance-wise, but it seemed good enough.  </p><p>The above code is used in the <em>enemiesActor</em>. On each pass we obtain the values from the kill function...</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(shotsLeft,deadEnemies) = kill enemies (heroShots w) []</code></pre></div><p>With <strong>w</strong> being the World. shotsLeft can simply be reassigned to the new World coming out of the actor. As to the dead enemies, they need to be considered when creating the enemy grid on the next render pass. For this we add the new dead to the already existing dead enemies that are also kept in the World state.</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token hvariable">w</span> 
	<span class="token punctuation">{</span> 
		<span class="token hvariable">enemyPosition</span> <span class="token operator">=</span> <span class="token hvariable">requiredChange</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token hvariable">enemyMovement</span> <span class="token operator">=</span> <span class="token builtin">snd</span> <span class="token hvariable">newMovePattern</span><span class="token punctuation">,</span>
		<span class="token hvariable">heroShots</span> <span class="token operator">=</span> <span class="token hvariable">shotsLeft</span><span class="token punctuation">,</span>
		<span class="token hvariable">mIA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">mIA</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token operator">++</span> <span class="token hvariable">deadEnemies</span>
	<span class="token punctuation">}</span></code></pre></div><p>The enemy grid is now constructed as follows</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">rows</span><span class="token punctuation">,</span> <span class="token hvariable">cols</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
	<span class="token punctuation">(</span><span class="token builtin">zipWith</span> <span class="token constant">Enemy</span> 
		<span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">cols</span> <span class="token punctuation">[</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originX</span><span class="token operator">+</span><span class="token number">60</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">y</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">rows</span> <span class="token punctuation">[</span><span class="token hvariable">originY</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token operator">+</span><span class="token number">30</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">]</span> 
		<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">\\</span> <span class="token punctuation">(</span><span class="token hvariable">mIA</span> <span class="token hvariable">w</span><span class="token punctuation">)</span></code></pre></div><p>The <em>zipWith</em> is pretty much a zip where you need to provide a function to construct what comes out of the two lists being zipped. To remind you what <strong>Enemy</strong> is...  </p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">WorldItem</span> <span class="token operator">=</span> <span class="token constant">Enemy</span> <span class="token constant">Point</span> <span class="token constant">Int</span> <span class="token operator">|</span> <span class="token constant">Hero</span> <span class="token constant">Point</span> <span class="token operator">|</span> <span class="token constant">Shot</span> <span class="token constant">Point</span></code></pre></div><p>the second list is hence just an Int that gives each enemy a unique Id. See, equality is not a given for things in a Haskell program. In order to use the <strong>\</strong> function between two lists, the items in the list need to be equatable. In Haskell we do this by making World Items an instance of <strong>Eq</strong>.</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">instance</span> <span class="token constant">Eq</span> <span class="token constant">WorldItem</span> <span class="token keyword">where</span>
	<span class="token punctuation">(</span><span class="token operator">==</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Enemy</span> <span class="token hvariable">_</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Enemy</span> <span class="token hvariable">_</span> <span class="token hvariable">pos</span>&#x27;<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">pos</span> <span class="token operator">==</span> <span class="token hvariable">pos</span>&#x27;
	<span class="token punctuation">(</span><span class="token operator">==</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Shot</span> <span class="token hvariable">p</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Shot</span> <span class="token hvariable">p</span>&#x27;<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">p</span> <span class="token operator">==</span> <span class="token hvariable">p</span>&#x27;
	<span class="token punctuation">(</span><span class="token operator">==</span><span class="token punctuation">)</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span> <span class="token operator">=</span> <span class="token constant">False</span></code></pre></div><p>Hence, enemies are compared through their id, which allows us to remove dead enemies irrespective of their current position. Shots on the other hand are compared by their position in the world. We used that equality when removing a shot that hit an enemy from the list of shots currently flying through the world.
The last line is pretty much a paranoid safe guard which isn&#x27;t strictly necessary. Pattern matches don&#x27;t seem to have to be complete - what can happen to you is a <em>non-exhaustive pattern match</em> - exception at runtime.</p><p>I didn&#x27;t want to make a fully fledged game, but I at least wanted the program to exit gracefully instead of due to some exception because some list was empty or the like.</p><p>Voila, the exit actor:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">exitActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token hvariable">exitActor</span> <span class="token hvariable">w</span>
	<span class="token operator">|</span> <span class="token builtin">length</span> <span class="token punctuation">(</span><span class="token hvariable">mIA</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">32</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">lastKey</span> <span class="token operator">=</span> <span class="token constant">SDLK_x</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">w</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div><p>The exit condition is having 32 dead enemies. Since the program already used the x key for exiting, it seemed not a bad choice to pipe in an &#x27;x&#x27; into the World state as if the user pressed it. This means introducing a little check in the loop:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">loop</span> <span class="token hvariable">world</span> <span class="token operator">=</span> <span class="token keyword">do</span> 
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token hvariable">lastKey</span> <span class="token hvariable">world</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">SDLK_x</span> <span class="token keyword">then</span> 
		<span class="token hvariable">FX.quit</span>
	<span class="token keyword">else</span>
		<span class="token hvariable">FX.pollEvent</span> <span class="token operator">&gt;&gt;=</span> <span class="token hvariable">handleEvent</span></code></pre></div><p>While Rob added a few more features to his clojure space invaders I conclude the series at this point. You can find the <a href="https://gist.github.com/flq/6515336">complete listing as a gist at github</a>.</p><p>What I would personally take away from this series...</p><ul><li>IO has been mystified far too much in Haskell. Fair enough, sensibly building own Monads may be a different story, but using IO is mostly a straightforward thing.</li><li>Even though the line count is not that high, there is quite some scope for improvement.</li><li>You can go pretty far in Haskell without Monads, Monad Transformers, Applicatives, Functors and with a fairly high percentage of pure functions. Granted, I do get the feeling I am missing out on a lot of toys...</li><li>The record syntax in Haskell is indeed somewhat clumsy, I hope to do a refactoring with Lenses, which would be a sort of Appendix blog post coming up.</li></ul><p>Finally, this is the complete code in one gist.</p><iframe width="100%" frameBorder="0" id="gist-6515336"></iframe></article><nav class="PreviousAndNext-module--navigation--123UK"><a class="PreviousAndNext-module--linkPrevious--2WFha PreviousAndNext-module--link--iq7Ea" aria-describedby="previousTitle" href="/2013/09/25/funspins-the-hero-shoots">&lt;</a><span id="previousTitle" class="PreviousAndNext-module--title--3-yUO">FunSpIns - The hero shoots.</span><span id="nextTitle" class="PreviousAndNext-module--title--3-yUO PreviousAndNext-module--border--dT-B7">We became impatient</span><a class="PreviousAndNext-module--linkNext--3jMS3 PreviousAndNext-module--link--iq7Ea" aria-describedby="nextTitle" href="/2013/11/11/we-became-impatient">&gt;</a></nav></main><footer class="Footer-module--main--1QC0I"><a rel="license noopener noreferrer" target="_new" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"/></a><p>Frank Quednau <!-- -->2021</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  window.excludeGAPaths=[/^(?:\/404)$/];
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1812710-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2013/09/26/funspins-collisions-the-dead-and-a-not-so-grateful-ending";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-72b219bae196683411be.js"],"app":["/app-18c5db79b52bec877cad.js"],"component---src-pages-404-js":["/component---src-pages-404-js-65e0e6024a51ef90147e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-938610e8d1e33912361f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-af6f54d0700b918d2163.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-289c177ccd69332b3e3d.js"],"component---src-templates-article-template-js":["/component---src-templates-article-template-js-f04abf4d737cf958b9a2.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-1d9c79df7cff12c7ff91.js"]};/*]]>*/</script><script src="/polyfill-72b219bae196683411be.js" nomodule=""></script><script src="/component---src-templates-article-template-js-f04abf4d737cf958b9a2.js" async=""></script><script src="/commons-5ffe1f2bcdc9b9fa2a3d.js" async=""></script><script src="/app-18c5db79b52bec877cad.js" async=""></script><script src="/framework-75034fa8e3a9e81ff051.js" async=""></script><script src="/webpack-runtime-c0e9b35e2527e2b6d994.js" async=""></script></body></html>