<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6c827614bcd63144d6db.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}:root{--linkColorMain:#af0000;--linkColorMainContrast:#c6f8ff;--linkColor:#1eaedb;--linkHoverHighlight:#fff 0px 0px 5px,#7791b3 0px 0px 10px;--background:#fff;--sidePadding:0.75rem;--topShadow:0px 5px 7px 0px rgba(0,0,0,0.55);--lightSeparator:1px solid #d3d3d3;--standardShadow:0 8px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;padding:0 var(--sidePadding) 0 var(--sidePadding)}a{color:var(--linkColor)}figcaption{text-align:center;font-style:italic;color:#777;display:block;margin-bottom:2em}img{display:block;margin:20px auto;max-width:100%;box-shadow:var(--standardShadow)}blockquote{background:#f9f9f9;border-left:10px solid #ccc;padding:.5rem 10px;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:"\201D";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}h1{font-size:2.1rem}h1,h2{line-height:1.2}h2{font-size:1.7rem}h3{line-height:1.2;letter-spacing:.05rem}h3,h4{font-size:1.5rem}h4{font-weight:lighter;font-style:italic}@media (min-width:768px){h1{font-size:2.5rem}h1,h2{line-height:1.3}h2{font-size:2rem}h3{line-height:1.1}h3,h4{font-size:1.7rem}}.layout-module--layout--3NElS{display:flex;flex-direction:column;align-items:center}.layout-module--main--1XJsu{padding:5rem 0 1rem;width:100%}@media (min-width:768px){.layout-module--main--1XJsu{width:90%}}@media (min-width:1200px){.layout-module--main--1XJsu{width:70%}}@media (min-width:2300px){.layout-module--main--1XJsu{width:55%}}.SiteHeader-module--siteNav--3VakG{display:flex;align-items:stretch;justify-content:center;padding:.5rem var(--sidePadding);box-shadow:var(--topShadow);background-color:var(--background);z-index:10;position:fixed;top:0;right:0;left:0}.SiteHeader-module--main--uZpGc{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.SiteHeader-module--siteHeader--3gDoz{font-family:Lora,serif;font-style:italic;letter-spacing:.01rem;text-shadow:2px 1px 1px #999;margin:0 1rem 0 0;font-size:2.2rem}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--siteLink--1QNau{text-decoration:none;display:inline-block}.SiteHeader-module--mainLink---Exlm:hover,.SiteHeader-module--siteLink--1QNau:hover{text-decoration:underline}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--mainLink---Exlm:visited,.SiteHeader-module--siteLink--1QNau,.SiteHeader-module--siteLink--1QNau:visited{color:var(--linkColorMain)}.SiteHeader-module--siteLink--1QNau:not(:first-child):before{content:" | ";color:#000;margin:0 .25rem;text-decoration:none;display:inline-block}@media (min-width:768px){.SiteHeader-module--main--uZpGc{width:90%}}@media (min-width:1200px){.SiteHeader-module--main--uZpGc{width:70%}}@media (min-width:2300px){.SiteHeader-module--main--uZpGc{width:55%}}.Footer-module--main--1QC0I{width:100%;display:flex;flex-direction:row;padding-top:.5rem;margin-bottom:2rem;justify-content:center;align-items:center;font-size:1rem;border-top:var(--lightSeparator)}.Footer-module--main--1QC0I img{margin:.25rem;box-shadow:none}.Footer-module--main--1QC0I p{margin:.25rem}@media (min-width:768px){.Footer-module--main--1QC0I{width:90%}}@media (min-width:1200px){.Footer-module--main--1QC0I{width:70%}}@media (min-width:2300px){.Footer-module--main--1QC0I{width:55%}}.tags-module--columnList--2IU2r{display:grid;list-style:circle inside;grid-auto-flow:row;grid-template-columns:repeat(auto-fill,300px);max-width:100%;font-size:1.2rem}.tags-module--columnList--2IU2r a{text-decoration:none}.tags-module--columnList--2IU2r a:hover{text-decoration:underline}.Tag-module--tags--3UNk1{margin-top:.5rem}.Tag-module--tag--3otWA{background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;font-size:1.1rem;margin-top:0;padding:.25rem}.Tag-module--tag--3otWA,.Tag-module--tagOuter--27OmX{border-top-right-radius:10px;border-bottom-right-radius:10px;border-top-left-radius:5px;border-bottom-left-radius:5px}.Tag-module--tagOuter--27OmX{display:inline-flex;margin:0 .5rem .5rem 0;padding:0;line-height:1.1rem;box-shadow:5px 5px 8px -8px rgba(0,0,0,.91)}.Tag-module--tagOuter--27OmX:hover{text-shadow:var(--linkHoverHighlight)}.Tag-module--tag--3otWA:after{margin-left:.75rem;font-size:1.5rem;vertical-align:middle;content:"•"}.YouTubeEmbed-module--frame--JPpxk{display:block;margin:20px auto;width:516px;height:315px;max-width:100%;box-shadow:var(--standardShadow)}.Info-module--infoContainer--1O0oR,.Tweet-module--tweet--1nwF8{display:flex;justify-content:center}.Info-module--info--1Qfs3{background:#c6f8ff;border-left:10px solid var(--linkColor);padding:1rem .25rem;margin-bottom:2.5rem;box-shadow:var(--standardShadow);width:95%;quotes:"\201C""\201D""\2018""\2019"}div.Info-module--info--1Qfs3:before{color:var(--linkColor);content:"\24D8";font-size:2em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}@media (min-width:768px){.Info-module--info--1Qfs3{width:80%}}@media (min-width:1200px){.Info-module--info--1Qfs3{width:70%}}.DateDisplay-module--dateContainer--1trkw{align-self:flex-start;display:inline-grid;grid-template-columns:0 auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.DateDisplay-module--month--2KOka{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.DateDisplay-module--date--oZxQz{display:flex;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch;justify-content:center;align-items:center}.DateDisplay-module--year--2577t{display:block;visibility:hidden;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.DateDisplay-module--excerpt--ac7UJ{font-size:1.4rem;margin:.25rem}@media (min-width:500px){.DateDisplay-module--dateContainer--1trkw{grid-template-columns:1.5rem 3rem}.DateDisplay-module--year--2577t{visibility:visible}}.postExcerpt-module--article--1YC-H{margin-bottom:3rem}.postExcerpt-module--article--1YC-H:last-of-type{margin-bottom:0}.postExcerpt-module--headerContainer--hcRy6{display:flex;flex-direction:row;align-items:center}.postExcerpt-module--header--1LVL4{font-size:1.7rem;line-height:2rem;margin:0 0 0 .5rem}.postExcerpt-module--header--1LVL4 a{text-decoration:none}.postExcerpt-module--header--1LVL4 a:hover{text-decoration:underline}.postExcerpt-module--dateContainer--3lfoy{align-self:flex-start;display:inline-grid;grid-template-columns:auto auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.postExcerpt-module--month--59SAH{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.postExcerpt-module--date--2LGbD{display:block;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch}.postExcerpt-module--year--w1z16{display:block;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.postExcerpt-module--excerpt--2vlk7{font-size:1.4rem;margin:.25rem}.TopicToc-module--container--iTCNh{border-radius:25px;background:#f9f9f9;box-shadow:var(--standardShadow)}.TopicToc-module--header--23y04{text-align:right;border-top-left-radius:25px;border-top-right-radius:25px;font-size:1.2em;background-color:#777;color:#fff;margin-bottom:0;padding:2px 20px 2px 0;font-style:italic}.TopicToc-module--list--d3sjU{list-style-type:upper-roman;margin:1rem;padding-bottom:1rem;list-style-position:outside}.Discussion-module--alpha--2wwoE{margin-right:20%}.Discussion-module--beta--280lX{margin-left:20%}.Discussion-module--alpha--2wwoE:before{content:"η: «"}.Discussion-module--alpha--2wwoE:after,.Discussion-module--beta--280lX:after{content:"»"}.Discussion-module--beta--280lX:before{content:"μ: «"}.articleTemplate-module--header--354F0{display:grid;grid-template-rows:auto auto;grid-template-columns:auto auto;column-gap:.25rem;font-size:1.2rem;margin-bottom:2rem}.articleTemplate-module--date--2zr35{grid-column:2;grid-row:1;justify-self:end}.articleTemplate-module--h1--2QcXm{grid-row:1;grid-column:1;margin:0}.articleTemplate-module--tags--1YeyG{grid-row:2;grid-column:1/span 2}.PreviousAndNext-module--navigation--123UK{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(2,auto);border:1px solid var(--linkColor);border-radius:5px}.PreviousAndNext-module--link--iq7Ea{display:flex;align-items:center;justify-content:center;padding:.25rem 1.5rem;background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;align-self:stretch;margin:.25rem;border-radius:5px}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1;grid-row:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:2;grid-row:1}.PreviousAndNext-module--disabled--oYrWw{opacity:.2}.PreviousAndNext-module--link--iq7Ea:hover{text-shadow:var(--linkHoverHighlight)}.PreviousAndNext-module--title--3-yUO{font-size:1rem;padding:0 .5rem}.PreviousAndNext-module--border--dT-B7{border-left:1px dashed var(--linkColor)}@media (min-width:768px){.PreviousAndNext-module--navigation--123UK{grid-template-columns:auto repeat(2,1fr) auto;grid-template-rows:auto}.PreviousAndNext-module--link--iq7Ea{margin:0;border-radius:0}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:4}.PreviousAndNext-module--border--dT-B7{border-left:1px solid var(--linkColor)}}.tagTemplate-module--articleList--1XmWn{font-size:1.2rem;list-style:circle inside}.tagTemplate-module--articleList--1XmWn a,.tagTemplate-module--articleListHeader--3yVYd a{text-decoration:none}.tagTemplate-module--articleList--1XmWn a:hover,.tagTemplate-module--articleListHeader--3yVYd a:hover{text-decoration:underline}</style><meta name="generator" content="Gatsby 3.4.2"/><title data-react-helmet="true">FunSpIns - Moving a Rectangle</title><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"/><link data-react-helmet="true" href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet"/><link data-react-helmet="true" href="//fonts.googleapis.com/css2?family=Lora:ital,wght@1,500&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Content from Frank Quednau about dev and fields of interest."/><meta data-react-helmet="true" name="keywords" content="programming, haskell"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="FunSpIns - Moving a Rectangle"/><meta data-react-helmet="true" name="twitter:site:id" content="fquednau"/><meta data-react-helmet="true" name="twitter:description" content="Inspired by Rob Ashton&#x27;s series &quot; Learn functional programming with me &quot; Last time a square got drawn, this time moving it would be nice. Rob&#x27;s…"/><meta data-react-helmet="true" name="twitter:image" content="/icons/icon-72x72.png"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Realfiction RSS" href="/atom.xml"/><link rel="icon" href="/favicon-32x32.png?v=4ebdacb62247bfbfe92c555d6c833c53" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-10fde4d716fb505c2984.js"/><link as="script" rel="preload" href="/framework-75034fa8e3a9e81ff051.js"/><link as="script" rel="preload" href="/app-4efc4d6aa7df27a3a823.js"/><link as="script" rel="preload" href="/commons-5ffe1f2bcdc9b9fa2a3d.js"/><link as="script" rel="preload" href="/component---src-templates-article-template-js-269013ae4575902adbfb.js"/><link as="fetch" rel="preload" href="/page-data/2013/09/19/funspins-moving-a-rectangle/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/256249292.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2581731408.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--layout--3NElS"><nav class="SiteHeader-module--siteNav--3VakG"><div class="SiteHeader-module--main--uZpGc"><h1 class="SiteHeader-module--siteHeader--3gDoz"><a class="SiteHeader-module--mainLink---Exlm" href="/">Realfiction</a></h1><div><a class="SiteHeader-module--siteLink--1QNau" href="/tags">Tags</a><a class="SiteHeader-module--siteLink--1QNau" href="/about">About</a></div></div></nav><main class="layout-module--main--1XJsu"><article><header class="articleTemplate-module--header--354F0"><time class="DateDisplay-module--dateContainer--1trkw articleTemplate-module--date--2zr35" dateTime="2013-09-19"><span class="DateDisplay-module--month--2KOka">Sep</span><span class="DateDisplay-module--date--oZxQz">19</span><span class="DateDisplay-module--year--2577t">2013</span></time><h1 class="articleTemplate-module--h1--2QcXm">FunSpIns - Moving a Rectangle</h1><nav class="Tag-module--tags--3UNk1 articleTemplate-module--tags--1YeyG"><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/programming">programming</a></div><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/haskell">haskell</a></div></nav></header><nav class="TopicToc-module--container--iTCNh"><h3 class="TopicToc-module--header--23y04">Functional space-invaders series</h3><ol class="TopicToc-module--list--d3sjU"><li><a href="/2013/09/17/funspins-a-recap-of-rob-ashtons-lessons-das-intro">FunSpIns - a recap of Rob Ashton&#x27;s lessons - Das Intro</a></li><li><a href="/2013/09/18/funspins-drawing-a-rectangle">FunSpIns - Drawing a Rectangle</a></li><li><span>FunSpIns - Moving a Rectangle</span></li><li><a href="/2013/09/20/funspins-no-attributes-no-vectors-a-tiny-workflow-and-more-squares">FunSpIns - No attributes, No vectors, A tiny Workflow and more squares</a></li><li><a href="/2013/09/23/funspins-state-the-world-the-loop">FunSpIns - State, the World, the Loop</a></li><li><a href="/2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter">FunSpIns - The hero must move, the enemies must move smarter.</a></li><li><a href="/2013/09/25/funspins-the-hero-shoots">FunSpIns - The hero shoots.</a></li><li><a href="/2013/09/26/funspins-collisions-the-dead-and-a-not-so-grateful-ending">FunSpIns - Collisions, the dead, and a (not so) grateful ending.</a></li></ol></nav><blockquote><p>Inspired by Rob Ashton&#x27;s series &quot;<a href="http://codeofrob.com/entries/learn-functional-programming-with-me---moving-the-square.html">Learn functional programming with me</a>&quot;</p></blockquote><p>Last time a square got drawn, this time moving it would be nice. Rob&#x27;s approach was based on a recursive function call,
one of the basic tools in FP to essentially do loops.</p><p>Another way to consider the movement would be to look at it as a list of numbers, or coordinates, that dictate at which position
the rectangle should be drawn. One weapon of choice in Haskell for sequences of things are <a href="http://learnyouahaskell.com/starting-out#im-a-list-comprehension">list comprehensions</a>.</p><blockquote><p>Incidentally I learned about list comprehensions in Erlang, which look very similar to Haskell&#x27;s </p></blockquote><p>Hence, from a given sequence I would create Rectangles that were ready to be drawn onto a screen:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Just</span> <span class="token punctuation">(</span><span class="token constant">Rect</span> <span class="token hvariable">x</span> <span class="token number">25</span> <span class="token number">50</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">450</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre></div><p>and for each one of those I would want to draw it on the screen, hence I prepared myself this function:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">fillDo</span> <span class="token hvariable">canvas</span> <span class="token hvariable">rect</span> <span class="token operator">=</span> <span class="token keyword">do</span> 
	 <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">canvas</span> <span class="token constant">Nothing</span> <span class="token punctuation">(</span><span class="token constant">Pixel</span> <span class="token number">0</span><span class="token punctuation">)</span>
	 <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">canvas</span> <span class="token hvariable">rect</span> <span class="token punctuation">(</span><span class="token constant">Pixel</span> <span class="token number">0xFFFFFF</span><span class="token punctuation">)</span>
	 <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">flip</span> <span class="token hvariable">canvas</span></code></pre></div><h2>The do-notation</h2><p>all SDL operations happen in the IO monad, which can be seen nicely when we look at the type of the involved functions:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token hvariable">FX.fillRect</span> <span class="token operator">::</span> <span class="token constant">Surface</span> <span class="token operator">-&gt;</span> <span class="token constant">Maybe</span> <span class="token constant">Rect</span> <span class="token operator">-&gt;</span> <span class="token constant">Pixel</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token constant">Bool</span>
    <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">flip</span> <span class="token operator">::</span> <span class="token constant">Surface</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><p>If we want to work with them, we will need to work in that context ourselves. Haskell has a number of functions to work with Monads, one of them being <strong>(&gt;&gt;)</strong>. Its type is</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token punctuation">(</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> <span class="token operator">::</span> <span class="token constant">Monad</span> <span class="token hvariable">m</span> <span class="token operator">=&gt;</span> <span class="token hvariable">m</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">m</span> <span class="token hvariable">b</span> <span class="token operator">-&gt;</span> <span class="token hvariable">m</span> <span class="token hvariable">b</span></code></pre></div><sup>*) Within the same monad, given a one-in, one-out function, return the output of the function</sup><p>It looks and sounds trivial, but actually allows to chain functions together that happen in the same context. i.e. something like</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token comment">-- putStr :: String -&gt; IO ()</span>
<span class="token builtin">putStr</span> <span class="token string">&quot;Hello&quot;</span> <span class="token operator">&gt;&gt;</span> 
<span class="token builtin">putStr</span> <span class="token string">&quot; &quot;</span>
<span class="token comment">--becomes</span>
<span class="token keyword">do</span>
	<span class="token builtin">putStr</span> <span class="token string">&quot;Hello&quot;</span>
	<span class="token builtin">putStr</span> <span class="token string">&quot; &quot;</span></code></pre></div><h2>List + fillDo = ...</h2><p>My initial attempt was to take my list of Rectangles and map the fillDo over it:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">map (fillDo canvas) [(Just (Rect x 25 50 50)) | x &lt;- [1..450]]</code></pre></div><p>Note the use of currying - (fillDo canvas) returns a function that takes a rect as a parameter and returns <strong>IO ()</strong>.</p><p>Alas, it wouldn&#x27;t compile. After some thinking and googling, the issue dawned on me: every function inside a do block
must return into the same context with which we started off. Alas, the last line of code did not return an <strong>IO sth</strong>, but
rather <strong>[IO sth]</strong>, an array of things in the IO context. What I wanted was actually <strong>IO <!-- -->[sth]</strong>.</p><blockquote><p>Once you get the hang out of it, Haskell errors can be quite understandable. This one was...</p></blockquote><div class="gatsby-highlight" data-language="cli"><pre class="language-cli"><code class="language-cli">Couldn&#x27;t match expected type `IO a0&#x27; with actual type `[b0]&#x27;
In the return type of a call of `map&#x27;
In a stmt of a &#x27;do&#x27; block:
... </code></pre></div><p>Thankfully there is a version of <strong>map</strong> with the kind of signature that we need:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]</code></pre></div><sup>*) Given a function taking a&#x27;s and returning b&#x27;s within m and an array of a&#x27;s, give me the resulting array of b&#x27;s, within the m context</sup><p>Bingo, small change and here&#x27;s the full program:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">module</span> <span class="token constant">Main</span> <span class="token keyword">where</span>

	<span class="token import-statement"><span class="token keyword">import</span> Graphics.UI.SDL <span class="token keyword">as</span> FX</span>

	<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
	<span class="token builtin">init</span>
	<span class="token hvariable">canvas</span> <span class="token operator">&lt;-</span> <span class="token hvariable">FX.getVideoSurface</span>
	<span class="token builtin">mapM</span> <span class="token punctuation">(</span><span class="token hvariable">fillDo</span> <span class="token hvariable">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token constant">Rect</span> <span class="token hvariable">x</span> <span class="token number">25</span> <span class="token number">50</span> <span class="token number">50</span> <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">450</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
	<span class="token hvariable">delay</span> <span class="token number">1000</span>
	<span class="token hvariable">FX.quit</span>
	<span class="token keyword">where</span>
		<span class="token hvariable">fillDo</span> <span class="token hvariable">canvas</span> <span class="token hvariable">rect</span> <span class="token operator">=</span> <span class="token keyword">do</span> 
		<span class="token hvariable">FX.fillRect</span> <span class="token hvariable">canvas</span> <span class="token constant">Nothing</span> <span class="token punctuation">(</span><span class="token constant">Pixel</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token hvariable">FX.fillRect</span> <span class="token hvariable">canvas</span> <span class="token punctuation">(</span><span class="token constant">Just</span> <span class="token hvariable">rect</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Pixel</span> <span class="token number">0xFFFFFF</span><span class="token punctuation">)</span>
		<span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">flip</span> <span class="token hvariable">canvas</span>
		<span class="token builtin">init</span> <span class="token operator">=</span> <span class="token keyword">do</span>
		<span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">init</span> <span class="token punctuation">[</span><span class="token constant">InitVideo</span><span class="token punctuation">]</span>
		<span class="token hvariable">FX.setVideoMode</span> <span class="token number">640</span> <span class="token number">480</span> <span class="token number">32</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre></div><p>So far I do not want to go full steam ahead and implement the <strong>logic/render/repeat</strong> thing, since, to be honest, I don&#x27;t quite see where this is heading. Even so,  there is some potential looming for separating logic from rendering as the production of the rectangle <em>&quot;path&quot;</em> can be looked at independent of <em>IO</em>. </p><h3>PS</h3><p>we saved ourselves the &quot;white smear&quot; stage by adding that canvas cleaning code in the <strong>fillDo</strong> (<em>FX.fillRect canvas Nothing (Pixel 0)</em>)</p></article><nav class="PreviousAndNext-module--navigation--123UK"><a class="PreviousAndNext-module--linkPrevious--2WFha PreviousAndNext-module--link--iq7Ea" aria-describedby="previousTitle" href="/2013/09/18/funspins-drawing-a-rectangle">&lt;</a><span id="previousTitle" class="PreviousAndNext-module--title--3-yUO">FunSpIns - Drawing a Rectangle</span><span id="nextTitle" class="PreviousAndNext-module--title--3-yUO PreviousAndNext-module--border--dT-B7">FunSpIns - No attributes, No vectors, A tiny Workflow and more squares</span><a class="PreviousAndNext-module--linkNext--3jMS3 PreviousAndNext-module--link--iq7Ea" aria-describedby="nextTitle" href="/2013/09/20/funspins-no-attributes-no-vectors-a-tiny-workflow-and-more-squares">&gt;</a></nav></main><footer class="Footer-module--main--1QC0I"><a rel="license noopener noreferrer" target="_new" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"/></a><p>Frank Quednau <!-- -->2021</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  window.excludeGAPaths=[/^(?:\/404)$/];
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1812710-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2013/09/19/funspins-moving-a-rectangle";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-72b219bae196683411be.js"],"app":["/app-4efc4d6aa7df27a3a823.js"],"component---src-pages-404-js":["/component---src-pages-404-js-65e0e6024a51ef90147e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-938610e8d1e33912361f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-af6f54d0700b918d2163.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-289c177ccd69332b3e3d.js"],"component---src-templates-article-template-js":["/component---src-templates-article-template-js-269013ae4575902adbfb.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-1d9c79df7cff12c7ff91.js"]};/*]]>*/</script><script src="/polyfill-72b219bae196683411be.js" nomodule=""></script><script src="/component---src-templates-article-template-js-269013ae4575902adbfb.js" async=""></script><script src="/commons-5ffe1f2bcdc9b9fa2a3d.js" async=""></script><script src="/app-4efc4d6aa7df27a3a823.js" async=""></script><script src="/framework-75034fa8e3a9e81ff051.js" async=""></script><script src="/webpack-runtime-10fde4d716fb505c2984.js" async=""></script></body></html>