<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6c827614bcd63144d6db.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}:root{--linkColorMain:#af0000;--linkColorMainContrast:#c6f8ff;--linkColor:#1eaedb;--linkHoverHighlight:#fff 0px 0px 5px,#7791b3 0px 0px 10px;--background:#fff;--sidePadding:0.75rem;--topShadow:0px 5px 7px 0px rgba(0,0,0,0.55);--lightSeparator:1px solid #d3d3d3;--standardShadow:0 8px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;padding:0 var(--sidePadding) 0 var(--sidePadding)}a{color:var(--linkColor)}figcaption{text-align:center;font-style:italic;color:#777;display:block;margin-bottom:2em}img{display:block;margin:20px auto;max-width:100%;box-shadow:var(--standardShadow)}blockquote{background:#f9f9f9;border-left:10px solid #ccc;padding:.5rem 10px;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:"\201D";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}h1{font-size:2.1rem}h1,h2{line-height:1.2}h2{font-size:1.7rem}h3{line-height:1.2;letter-spacing:.05rem}h3,h4{font-size:1.5rem}h4{font-weight:lighter;font-style:italic}@media (min-width:768px){h1{font-size:2.5rem}h1,h2{line-height:1.3}h2{font-size:2rem}h3{line-height:1.1}h3,h4{font-size:1.7rem}}.layout-module--layout--3NElS{display:flex;flex-direction:column;align-items:center}.layout-module--main--1XJsu{padding:5rem 0 1rem;width:100%}@media (min-width:768px){.layout-module--main--1XJsu{width:90%}}@media (min-width:1200px){.layout-module--main--1XJsu{width:70%}}@media (min-width:2300px){.layout-module--main--1XJsu{width:55%}}.SiteHeader-module--siteNav--3VakG{display:flex;align-items:stretch;justify-content:center;padding:.5rem var(--sidePadding);box-shadow:var(--topShadow);background-color:var(--background);z-index:10;position:fixed;top:0;right:0;left:0}.SiteHeader-module--main--uZpGc{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.SiteHeader-module--siteHeader--3gDoz{font-family:Lora,serif;font-style:italic;letter-spacing:.01rem;text-shadow:2px 1px 1px #999;margin:0 1rem 0 0;font-size:2.2rem}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--siteLink--1QNau{text-decoration:none;display:inline-block}.SiteHeader-module--mainLink---Exlm:hover,.SiteHeader-module--siteLink--1QNau:hover{text-decoration:underline}.SiteHeader-module--mainLink---Exlm,.SiteHeader-module--mainLink---Exlm:visited,.SiteHeader-module--siteLink--1QNau,.SiteHeader-module--siteLink--1QNau:visited{color:var(--linkColorMain)}.SiteHeader-module--siteLink--1QNau:not(:first-child):before{content:" | ";color:#000;margin:0 .25rem;text-decoration:none;display:inline-block}@media (min-width:768px){.SiteHeader-module--main--uZpGc{width:90%}}@media (min-width:1200px){.SiteHeader-module--main--uZpGc{width:70%}}@media (min-width:2300px){.SiteHeader-module--main--uZpGc{width:55%}}.Footer-module--main--1QC0I{width:100%;display:flex;flex-direction:row;padding-top:.5rem;margin-bottom:2rem;justify-content:center;align-items:center;font-size:1rem;border-top:var(--lightSeparator)}.Footer-module--main--1QC0I img{margin:.25rem;box-shadow:none}.Footer-module--main--1QC0I p{margin:.25rem}@media (min-width:768px){.Footer-module--main--1QC0I{width:90%}}@media (min-width:1200px){.Footer-module--main--1QC0I{width:70%}}@media (min-width:2300px){.Footer-module--main--1QC0I{width:55%}}.tags-module--columnList--2IU2r{display:grid;list-style:circle inside;grid-auto-flow:row;grid-template-columns:repeat(auto-fill,300px);max-width:100%;font-size:1.2rem}.tags-module--columnList--2IU2r a{text-decoration:none}.tags-module--columnList--2IU2r a:hover{text-decoration:underline}.Tag-module--tags--3UNk1{margin-top:.5rem}.Tag-module--tag--3otWA{background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;font-size:1.1rem;margin-top:0;padding:.25rem}.Tag-module--tag--3otWA,.Tag-module--tagOuter--27OmX{border-top-right-radius:10px;border-bottom-right-radius:10px;border-top-left-radius:5px;border-bottom-left-radius:5px}.Tag-module--tagOuter--27OmX{display:inline-flex;margin:0 .5rem .5rem 0;padding:0;line-height:1.1rem;box-shadow:5px 5px 8px -8px rgba(0,0,0,.91)}.Tag-module--tagOuter--27OmX:hover{text-shadow:var(--linkHoverHighlight)}.Tag-module--tag--3otWA:after{margin-left:.75rem;font-size:1.5rem;vertical-align:middle;content:"•"}.YouTubeEmbed-module--frame--JPpxk{display:block;margin:20px auto;width:516px;height:315px;max-width:100%;box-shadow:var(--standardShadow)}.Info-module--infoContainer--1O0oR,.Tweet-module--tweet--1nwF8{display:flex;justify-content:center}.Info-module--info--1Qfs3{background:#c6f8ff;border-left:10px solid var(--linkColor);padding:1rem .25rem;margin-bottom:2.5rem;box-shadow:var(--standardShadow);width:95%;quotes:"\201C""\201D""\2018""\2019"}div.Info-module--info--1Qfs3:before{color:var(--linkColor);content:"\24D8";font-size:2em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}@media (min-width:768px){.Info-module--info--1Qfs3{width:80%}}@media (min-width:1200px){.Info-module--info--1Qfs3{width:70%}}.DateDisplay-module--dateContainer--1trkw{align-self:flex-start;display:inline-grid;grid-template-columns:0 auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.DateDisplay-module--month--2KOka{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.DateDisplay-module--date--oZxQz{display:flex;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch;justify-content:center;align-items:center}.DateDisplay-module--year--2577t{display:block;visibility:hidden;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.DateDisplay-module--excerpt--ac7UJ{font-size:1.4rem;margin:.25rem}@media (min-width:500px){.DateDisplay-module--dateContainer--1trkw{grid-template-columns:1.5rem 3rem}.DateDisplay-module--year--2577t{visibility:visible}}.postExcerpt-module--article--1YC-H{margin-bottom:3rem}.postExcerpt-module--article--1YC-H:last-of-type{margin-bottom:0}.postExcerpt-module--headerContainer--hcRy6{display:flex;flex-direction:row;align-items:center}.postExcerpt-module--header--1LVL4{font-size:1.7rem;line-height:2rem;margin:0 0 0 .5rem}.postExcerpt-module--header--1LVL4 a{text-decoration:none}.postExcerpt-module--header--1LVL4 a:hover{text-decoration:underline}.postExcerpt-module--dateContainer--3lfoy{align-self:flex-start;display:inline-grid;grid-template-columns:auto auto;grid-template-rows:auto auto;border:1px solid var(--linkColorMain);border-radius:5px}.postExcerpt-module--month--59SAH{font-size:1rem;line-height:1rem;text-align:center;padding:.25rem .5rem;display:block;grid-column:2;grid-row:1}.postExcerpt-module--date--2LGbD{display:block;grid-column:2;grid-row:2;background-color:var(--linkColorMain);color:#fff;padding:.25rem 0;font-size:1.2rem;line-height:1.2rem;text-align:center;justify-self:stretch}.postExcerpt-module--year--w1z16{display:block;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;grid-column:1;grid-row:1/span 2;padding:.25rem;line-height:1rem}.postExcerpt-module--excerpt--2vlk7{font-size:1.4rem;margin:.25rem}.TopicToc-module--container--iTCNh{border-radius:25px;background:#f9f9f9;box-shadow:var(--standardShadow)}.TopicToc-module--header--23y04{text-align:right;border-top-left-radius:25px;border-top-right-radius:25px;font-size:1.2em;background-color:#777;color:#fff;margin-bottom:0;padding:2px 20px 2px 0;font-style:italic}.TopicToc-module--list--d3sjU{list-style-type:upper-roman;margin:1rem;padding-bottom:1rem;list-style-position:outside}.Discussion-module--alpha--2wwoE{margin-right:20%}.Discussion-module--beta--280lX{margin-left:20%}.Discussion-module--alpha--2wwoE:before{content:"η: «"}.Discussion-module--alpha--2wwoE:after,.Discussion-module--beta--280lX:after{content:"»"}.Discussion-module--beta--280lX:before{content:"μ: «"}.articleTemplate-module--header--354F0{display:grid;grid-template-rows:auto auto;grid-template-columns:auto auto;column-gap:.25rem;font-size:1.2rem;margin-bottom:2rem}.articleTemplate-module--date--2zr35{grid-column:2;grid-row:1;justify-self:end}.articleTemplate-module--h1--2QcXm{grid-row:1;grid-column:1;margin:0}.articleTemplate-module--tags--1YeyG{grid-row:2;grid-column:1/span 2}.PreviousAndNext-module--navigation--123UK{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(2,auto);border:1px solid var(--linkColor);border-radius:5px}.PreviousAndNext-module--link--iq7Ea{display:flex;align-items:center;justify-content:center;padding:.25rem 1.5rem;background-color:var(--linkColor);color:var(--linkColorMainContrast);text-decoration:none;align-self:stretch;margin:.25rem;border-radius:5px}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1;grid-row:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:2;grid-row:1}.PreviousAndNext-module--disabled--oYrWw{opacity:.2}.PreviousAndNext-module--link--iq7Ea:hover{text-shadow:var(--linkHoverHighlight)}.PreviousAndNext-module--title--3-yUO{font-size:1rem;padding:0 .5rem}.PreviousAndNext-module--border--dT-B7{border-left:1px dashed var(--linkColor)}@media (min-width:768px){.PreviousAndNext-module--navigation--123UK{grid-template-columns:auto repeat(2,1fr) auto;grid-template-rows:auto}.PreviousAndNext-module--link--iq7Ea{margin:0;border-radius:0}.PreviousAndNext-module--linkPrevious--2WFha{grid-column:1}.PreviousAndNext-module--linkNext--3jMS3{grid-column:4}.PreviousAndNext-module--border--dT-B7{border-left:1px solid var(--linkColor)}}.tagTemplate-module--articleList--1XmWn{font-size:1.2rem;list-style:circle inside}.tagTemplate-module--articleList--1XmWn a,.tagTemplate-module--articleListHeader--3yVYd a{text-decoration:none}.tagTemplate-module--articleList--1XmWn a:hover,.tagTemplate-module--articleListHeader--3yVYd a:hover{text-decoration:underline}</style><meta name="generator" content="Gatsby 3.4.2"/><title data-react-helmet="true">FunSpIns - The hero must move, the enemies must move smarter.</title><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"/><link data-react-helmet="true" href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet"/><link data-react-helmet="true" href="//fonts.googleapis.com/css2?family=Lora:ital,wght@1,500&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Content from Frank Quednau about dev and fields of interest."/><meta data-react-helmet="true" name="keywords" content="programming, haskell"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Realfiction RSS" href="/atom.xml"/><link rel="icon" href="/favicon-32x32.png?v=4ebdacb62247bfbfe92c555d6c833c53" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4ebdacb62247bfbfe92c555d6c833c53"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-28dee529fc8907086abe.js"/><link as="script" rel="preload" href="/framework-75034fa8e3a9e81ff051.js"/><link as="script" rel="preload" href="/app-18c5db79b52bec877cad.js"/><link as="script" rel="preload" href="/commons-5ffe1f2bcdc9b9fa2a3d.js"/><link as="script" rel="preload" href="/component---src-templates-article-template-js-28d624f11000afe2f997.js"/><link as="fetch" rel="preload" href="/page-data/2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/256249292.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2581731408.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--layout--3NElS"><nav class="SiteHeader-module--siteNav--3VakG"><div class="SiteHeader-module--main--uZpGc"><h1 class="SiteHeader-module--siteHeader--3gDoz"><a class="SiteHeader-module--mainLink---Exlm" href="/">Realfiction</a></h1><div><a class="SiteHeader-module--siteLink--1QNau" href="/tags">Tags</a><a class="SiteHeader-module--siteLink--1QNau" href="/about">About</a></div></div></nav><main class="layout-module--main--1XJsu"><article><header class="articleTemplate-module--header--354F0"><time class="DateDisplay-module--dateContainer--1trkw articleTemplate-module--date--2zr35" dateTime="2013-09-24"><span class="DateDisplay-module--month--2KOka">Sep</span><span class="DateDisplay-module--date--oZxQz">24</span><span class="DateDisplay-module--year--2577t">2013</span></time><h1 class="articleTemplate-module--h1--2QcXm">FunSpIns - The hero must move, the enemies must move smarter.</h1><nav class="Tag-module--tags--3UNk1 articleTemplate-module--tags--1YeyG"><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/programming">programming</a></div><div class="Tag-module--tagOuter--27OmX"><a class="Tag-module--tag--3otWA" href="/tags/haskell">haskell</a></div></nav></header><nav class="TopicToc-module--container--iTCNh"><h3 class="TopicToc-module--header--23y04">Functional space-invaders series</h3><ol class="TopicToc-module--list--d3sjU"><li><a href="/2013/09/17/funspins-a-recap-of-rob-ashtons-lessons-das-intro">FunSpIns - a recap of Rob Ashton&#x27;s lessons - Das Intro</a></li><li><a href="/2013/09/18/funspins-drawing-a-rectangle">FunSpIns - Drawing a Rectangle</a></li><li><a href="/2013/09/19/funspins-moving-a-rectangle">FunSpIns - Moving a Rectangle</a></li><li><a href="/2013/09/20/funspins-no-attributes-no-vectors-a-tiny-workflow-and-more-squares">FunSpIns - No attributes, No vectors, A tiny Workflow and more squares</a></li><li><a href="/2013/09/23/funspins-state-the-world-the-loop">FunSpIns - State, the World, the Loop</a></li><li><span>FunSpIns - The hero must move, the enemies must move smarter.</span></li><li><a href="/2013/09/25/funspins-the-hero-shoots">FunSpIns - The hero shoots.</a></li><li><a href="/2013/09/26/funspins-collisions-the-dead-and-a-not-so-grateful-ending">FunSpIns - Collisions, the dead, and a (not so) grateful ending.</a></li></ol></nav><blockquote><p>Inspired by Rob Ashton&#x27;s series &quot;<a href="http://codeofrob.com/entries/learn-functional-programming-with-me---keyboard-input-for-our-red-square.html">Learn functional programming with me</a>&quot;
It is time to feed things back to the actors! The actor signature did change a teeny bit:</p></blockquote><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">type</span> <span class="token constant">Point</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span><span class="token constant">Int</span><span class="token punctuation">)</span>
<span class="token keyword">data</span> <span class="token constant">ItemColor</span> <span class="token operator">=</span> <span class="token constant">White</span> <span class="token operator">|</span> <span class="token constant">Red</span> <span class="token operator">|</span> <span class="token constant">Black</span>
<span class="token keyword">data</span> <span class="token constant">WorldItem</span> <span class="token operator">=</span> <span class="token constant">WorldItem</span> <span class="token constant">Point</span> <span class="token constant">ItemColor</span>
<span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div><p>That way we will be able to tell the rendering what colour we want our rectangles to be.</p><p>So, our enemies actor becomes:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token hvariable">enemiesActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token hvariable">enemiesActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span>
      <span class="token keyword">where</span>
        <span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">enemyPosition</span> <span class="token operator">=</span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token hvariable">enemies</span> <span class="token operator">=</span> <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">rows</span><span class="token punctuation">,</span> <span class="token hvariable">cols</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
          <span class="token builtin">map</span> <span class="token hvariable">enemy</span> <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">cols</span> <span class="token punctuation">[</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originX</span><span class="token operator">+</span><span class="token number">60</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">y</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">rows</span> <span class="token punctuation">[</span><span class="token hvariable">originY</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token operator">+</span><span class="token number">30</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token hvariable">enemy</span> <span class="token hvariable">p</span> <span class="token operator">=</span> <span class="token constant">WorldItem</span> <span class="token hvariable">p</span> <span class="token constant">White</span></code></pre></div><p>changeX is a new method with a pretty simple implementation:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token hvariable">changeX</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">f</span> <span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span></code></pre></div><p>From which you can conclude that (+2) is actually a function, namely adding two to whatever supports adding twos to them.</p><p>Some changes where done on the loop. Indeed, there was no bail-out condition, which is introduced by checking whether &#x27;x&#x27; is pressed.
Also, I don&#x27;t want to react to any mouse events, hence it is sufficient to just pass on any key that is pressed by the gamer. The main and loop functions got some refactoring:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
      <span class="token hvariable">canvas</span> <span class="token operator">&lt;-</span> <span class="token builtin">init</span>
      <span class="token hvariable">loop</span> <span class="token operator">$</span> <span class="token hvariable">initWorld</span> <span class="token hvariable">canvas</span>
      <span class="token keyword">where</span>
        <span class="token builtin">init</span> <span class="token operator">=</span> <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">init</span> <span class="token punctuation">[</span><span class="token constant">InitVideo</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">FX.setVideoMode</span> <span class="token number">640</span> <span class="token number">480</span> <span class="token number">32</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token hvariable">FX.getVideoSurface</span></code></pre></div><p>As you can see main is pretty much toned down to set up the SDL stuff and start looping with an initial version of our World. Loop became its own function:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">loop</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">loop</span> <span class="token hvariable">world</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token hvariable">FX.pollEvent</span> <span class="token operator">&gt;&gt;=</span> <span class="token hvariable">handleEvent</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">handleEvent</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">x</span> <span class="token keyword">of</span>
        <span class="token constant">KeyDown</span> <span class="token punctuation">(</span><span class="token constant">Keysym</span> <span class="token constant">SDLK_x</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">FX.quit</span>
        <span class="token constant">KeyDown</span> <span class="token punctuation">(</span><span class="token constant">Keysym</span> <span class="token hvariable">key</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">render</span> <span class="token hvariable">key</span> <span class="token operator">&gt;&gt;=</span> <span class="token hvariable">loop</span>
        <span class="token constant">KeyUp</span> <span class="token hvariable">_</span> <span class="token operator">-&gt;</span> <span class="token hvariable">render</span> <span class="token constant">SDLK_UNKNOWN</span> <span class="token operator">&gt;&gt;=</span> <span class="token hvariable">loop</span>
        <span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">render</span> <span class="token punctuation">(</span><span class="token hvariable">lastKey</span> <span class="token hvariable">world</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;=</span> <span class="token hvariable">loop</span>
    <span class="token hvariable">render</span> <span class="token hvariable">e</span> <span class="token operator">=</span> <span class="token keyword">do</span>
      <span class="token keyword">let</span> <span class="token hvariable">c</span> <span class="token operator">=</span> <span class="token hvariable">canvas</span> <span class="token hvariable">world</span>
      <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">c</span> <span class="token constant">Nothing</span> <span class="token hvariable">black</span>
      <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span><span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token builtin">foldl</span> <span class="token hvariable">runActor</span> <span class="token punctuation">(</span><span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">lastKey</span> <span class="token operator">=</span> <span class="token hvariable">e</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">actors</span> <span class="token hvariable">world</span>
      <span class="token builtin">mapM</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">wi</span> <span class="token operator">-&gt;</span> <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">c</span> <span class="token punctuation">(</span><span class="token hvariable">getRect</span> <span class="token hvariable">wi</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">getPixel</span> <span class="token hvariable">wi</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">items</span>
      <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">flip</span> <span class="token hvariable">c</span>
      <span class="token hvariable">FX.delay</span> <span class="token number">40</span>
      <span class="token builtin">return</span> <span class="token hvariable">newWorld</span>
    <span class="token hvariable">runActor</span> <span class="token punctuation">(</span><span class="token hvariable">wld</span><span class="token punctuation">,</span> <span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token hvariable">actor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span> <span class="token hvariable">items</span><span class="token operator">++</span><span class="token hvariable">moreItems</span><span class="token punctuation">)</span>
      <span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span><span class="token hvariable">moreItems</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">actor</span> <span class="token hvariable">wld</span></code></pre></div><p>the value of <strong>pollEvent</strong> is bound to the <strong>handleEvent</strong> function. That one is responsible for our bailout (matching on a keydown event where <strong>x</strong> is pressed), as well as keeping the loop going in any other event. </p><p>One speciality is that we extract the pressed key, and in case of any other event that may come through we do as if some unknown key would have been pressed. Hence, our World now does not keep the whole SDL event, but just the last key pressed. <strong>Also</strong>, while no KeyUp event is coming along, we moving the lastKey of the previous  world on to the next. This has the nice effect that our actors will react to the keydown event as long as the given key is pressed (<em>Your keyboard will thank me!</em>). <strong>getRect</strong> and <strong>getPixel</strong> functions are helpers to map from our <strong>WorldItem</strong> into the SDL data types.</p><p>Now that we have a nice key event hanging around in the <em>World</em>, let&#x27;s get our hero into the equation:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">heroActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token hvariable">heroActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">hero</span> <span class="token hvariable">newState</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token hvariable">lastKey</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
      <span class="token constant">SDLK_LEFT</span> <span class="token operator">-&gt;</span> <span class="token hvariable">move</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token constant">SDLK_RIGHT</span> <span class="token operator">-&gt;</span> <span class="token hvariable">move</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>
      <span class="token hvariable">_</span> <span class="token operator">-&gt;</span> <span class="token hvariable">w</span>
    <span class="token hvariable">hero</span> <span class="token punctuation">(</span><span class="token constant">World</span> <span class="token punctuation">{</span> <span class="token hvariable">heroPosition</span> <span class="token operator">=</span> <span class="token hvariable">p</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">WorldItem</span> <span class="token hvariable">p</span> <span class="token constant">Red</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token hvariable">move</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">heroPosition</span> <span class="token operator">=</span> <span class="token hvariable">changeX</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">heroPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></code></pre></div><p>Depending on whether the user pressed left or right cursor key, we define the position of our hero in the World and create the corresponding <em>WorldItem</em>. I also need to match any other key, otherwise a <em>non-exhaustive pattern match</em> error will occur at runtime -  in this case we leave the world unchanged.</p><h3>Enemy movement</h3><p>Rob got somewhat ahead of me in that he has already sorted out the enemies moving from left to right and back, etc. - My enemies are currently edlessly wandering towards the left, leaving the screen and escaping the <em>righteous vengeance</em> of our world-defending hero.</p><p>For this I introduce a new state into the world:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">World</span> <span class="token operator">=</span> <span class="token constant">World</span> 
    <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token hvariable">enemyMovement</span> <span class="token operator">::</span> <span class="token constant">MovementPattern</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span></code></pre></div><p>where <strong>MovementPattern</strong> is defined as </p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">type</span> <span class="token constant">MovementPattern</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Movement</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token constant">Bool</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">data</span> <span class="token constant">Movement</span> <span class="token operator">=</span> <span class="token constant">Rght</span> <span class="token operator">|</span> <span class="token constant">Dwn</span> <span class="token operator">|</span> <span class="token constant">Lft</span> <span class="token keyword">deriving</span> <span class="token constant">Show</span></code></pre></div><p>A pattern is therefore a number of Tuples consisting of a movement definition and a function that evaluates to true/false based on an input of Points. The way to use the pattern is as follows:</p><ul><li>Extract the points from whatever <strong>WorldItem</strong>s you want to consider</li><li>If the function of the first element evaluates to True, leave things as they are</li><li>If the function of the first element evaluates to False, roll over the pattern - first becomes last, second becomes first.</li></ul><p>So I go ahead and express that code-wise:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">evaluateMovePattern</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span><span class="token constant">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token constant">MovementPattern</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Movement</span><span class="token punctuation">,</span><span class="token constant">MovementPattern</span><span class="token punctuation">)</span>
<span class="token hvariable">evaluateMovePattern</span> <span class="token hvariable">items</span> <span class="token hvariable">pattern</span> <span class="token operator">=</span> 
  <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token hvariable">evaluate</span> <span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
      <span class="token constant">True</span> <span class="token operator">-&gt;</span> <span class="token hvariable">next</span> <span class="token hvariable">pattern</span>
      <span class="token constant">False</span> <span class="token operator">-&gt;</span> <span class="token hvariable">next</span> <span class="token hvariable">newPattern</span>
      <span class="token keyword">where</span> 
        <span class="token hvariable">evaluate</span> <span class="token operator">=</span> <span class="token builtin">snd</span> <span class="token operator">$</span> <span class="token builtin">head</span> <span class="token hvariable">pattern</span>
        <span class="token hvariable">next</span> <span class="token hvariable">p</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">nextMove</span> <span class="token hvariable">p</span><span class="token punctuation">,</span> <span class="token hvariable">p</span><span class="token punctuation">)</span>
        <span class="token hvariable">newPattern</span> <span class="token operator">=</span> <span class="token hvariable">roll</span> <span class="token hvariable">pattern</span>
        <span class="token hvariable">nextMove</span> <span class="token punctuation">(</span><span class="token hvariable">m</span><span class="token operator">:</span><span class="token hvariable">ms</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token builtin">fst</span> <span class="token hvariable">m</span></code></pre></div><p>where <strong>fst</strong>, <strong>snd</strong> are <a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html">Prelude</a> functions to extract the first and second value of a tuple, respectively. roll is just <strong>roll (x:xs) = xs++<!-- -->[x]</strong>.
Armed with the ability to evaluate a movement pattern, let&#x27;s define one in the initialization of our World:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">initWorld</span> <span class="token hvariable">canvas</span> <span class="token operator">=</span> <span class="token constant">World</span> 
    <span class="token punctuation">{</span> 
        <span class="token operator">...</span> 
        <span class="token hvariable">enemyMovement</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Rght</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">&lt;=</span><span class="token number">620</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token hvariable">maxX</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Dwn</span><span class="token punctuation">,</span><span class="token hvariable">alwaysFalse</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Lft</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token hvariable">minX</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Dwn</span><span class="token punctuation">,</span><span class="token hvariable">alwaysFalse</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token comment">-- with ..</span>
<span class="token hvariable">getX</span> <span class="token operator">::</span> <span class="token constant">Num</span> <span class="token hvariable">a</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">a</span><span class="token punctuation">,</span><span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">getX</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">x</span>
<span class="token hvariable">boundX</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token hvariable">getX</span><span class="token operator"> . </span><span class="token punctuation">(</span><span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">comparing</span> <span class="token hvariable">getX</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token hvariable">maxX</span> <span class="token operator">=</span> <span class="token hvariable">boundX</span> <span class="token hvariable">maximumBy</span>
<span class="token hvariable">minX</span> <span class="token operator">=</span> <span class="token hvariable">boundX</span> <span class="token hvariable">minimumBy</span></code></pre></div><p>Hence, the pattern is right, while the maximum X of our point cloud is smaller than 620, the one time down (alwaysFalse returns false for whatever input), then left while the smallest X of the point cloud is bigger than 0, the one time down.</p><p>We can use this in our enemy actor to make sure that it moves properly throughout the screen:</p><div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">    <span class="token hvariable">enemiesActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token hvariable">enemiesActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span>
      <span class="token keyword">where</span>
        <span class="token hvariable">enemies</span> <span class="token operator">=</span> <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        <span class="token hvariable">newMovePattern</span> <span class="token operator">=</span> <span class="token hvariable">evaluateMovePattern</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token hvariable">getPoint</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">enemyMovement</span> <span class="token hvariable">w</span><span class="token punctuation">)</span>
        <span class="token hvariable">requiredChange</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token builtin">fst</span> <span class="token hvariable">newMovePattern</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
          <span class="token constant">Rght</span> <span class="token operator">-&gt;</span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span>
          <span class="token constant">Lft</span> <span class="token operator">-&gt;</span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token constant">Dwn</span> <span class="token operator">-&gt;</span> <span class="token hvariable">changeY</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">enemyPosition</span> <span class="token operator">=</span> <span class="token hvariable">requiredChange</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">enemyMovement</span> <span class="token operator">=</span> <span class="token builtin">snd</span> <span class="token hvariable">newMovePattern</span> <span class="token punctuation">}</span>
        <span class="token operator">...</span></code></pre></div><p>Based on the current Movement, the enemy position is changed for the next iteration through our world.</p><p>At this point in the series we have...</p><ul><li>A bunch of enemies that move left to right, slowly coming down</li><li>A red hero that can be moved to the left and the right</li></ul><p>Doesn&#x27;t sound terribly impressive, but the total LoC is about 117, and that from a FP noob, but we have still some way to go.</p></article><nav class="PreviousAndNext-module--navigation--123UK"><a class="PreviousAndNext-module--linkPrevious--2WFha PreviousAndNext-module--link--iq7Ea" aria-describedby="previousTitle" href="/2013/09/23/funspins-state-the-world-the-loop">&lt;</a><span id="previousTitle" class="PreviousAndNext-module--title--3-yUO">FunSpIns - State, the World, the Loop</span><span id="nextTitle" class="PreviousAndNext-module--title--3-yUO PreviousAndNext-module--border--dT-B7">FunSpIns - The hero shoots.</span><a class="PreviousAndNext-module--linkNext--3jMS3 PreviousAndNext-module--link--iq7Ea" aria-describedby="nextTitle" href="/2013/09/25/funspins-the-hero-shoots">&gt;</a></nav></main><footer class="Footer-module--main--1QC0I"><a rel="license noopener noreferrer" target="_new" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"/></a><p>Frank Quednau <!-- -->2021</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  window.excludeGAPaths=[/^(?:\/404)$/];
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1812710-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-72b219bae196683411be.js"],"app":["/app-18c5db79b52bec877cad.js"],"component---src-pages-404-js":["/component---src-pages-404-js-65e0e6024a51ef90147e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-938610e8d1e33912361f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-af6f54d0700b918d2163.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-289c177ccd69332b3e3d.js"],"component---src-templates-article-template-js":["/component---src-templates-article-template-js-28d624f11000afe2f997.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-1d9c79df7cff12c7ff91.js"]};/*]]>*/</script><script src="/polyfill-72b219bae196683411be.js" nomodule=""></script><script src="/component---src-templates-article-template-js-28d624f11000afe2f997.js" async=""></script><script src="/commons-5ffe1f2bcdc9b9fa2a3d.js" async=""></script><script src="/app-18c5db79b52bec877cad.js" async=""></script><script src="/framework-75034fa8e3a9e81ff051.js" async=""></script><script src="/webpack-runtime-28dee529fc8907086abe.js" async=""></script></body></html>