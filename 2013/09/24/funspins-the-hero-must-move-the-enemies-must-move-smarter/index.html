<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/app.a03716562d1e590f30ef.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{position:relative;margin:.5em 0;overflow:visible;padding:0}pre[class*=language-]>code{position:relative;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-size:3em 3em;background-origin:content-box;background-attachment:local}code[class*=language]{max-height:inherit;height:inherit;padding:0 1em;display:block;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{position:relative;padding:.2em;border-radius:.3em;color:#c92c2c;border:1px solid rgba(0,0,0,.1);display:inline;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{content:"";z-index:-2;display:block;position:absolute;bottom:.75em;left:.18em;width:40%;height:20%;max-height:13em;box-shadow:0 13px 8px #979797;-webkit-transform:rotate(-2deg);transform:rotate(-2deg)}:not(pre)>code[class*=language-]:after,pre[class*=language-]:after{right:.75em;left:auto;-webkit-transform:rotate(2deg);transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}.token.cr:before,.token.lf:before,.token.tab:not(:empty):before{color:#e0d7d1}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}</style><style data-href="/0.63a74e6388b867dbfc03.css">/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}.container{position:relative;max-width:1260px;margin:0 auto;padding:0 20px}.column,.columns,.container{width:100%;box-sizing:border-box}.column,.columns{float:left}@media (min-width:400px){.container{width:85%;padding:0}}@media (min-width:550px){.container{width:80%}.column,.columns{margin-left:4%}.column:first-child,.columns:first-child{margin-left:0}.one.column,.one.columns{width:4.66666666667%}.two.columns{width:13.3333333333%}.three.columns{width:22%}.four.columns{width:30.6666666667%}.five.columns{width:39.3333333333%}.six.columns{width:48%}.seven.columns{width:56.6666666667%}.eight.columns{width:65.3333333333%}.nine.columns{width:74%}.ten.columns{width:82.6666666667%}.eleven.columns{width:91.3333333333%}.twelve.columns{width:100%;margin-left:0}.one-third.column{width:30.6666666667%}.two-thirds.column{width:65.3333333333%}.one-half.column{width:48%}.offset-by-one.column,.offset-by-one.columns{margin-left:8.66666666667%}.offset-by-two.column,.offset-by-two.columns{margin-left:17.3333333333%}.offset-by-three.column,.offset-by-three.columns{margin-left:26%}.offset-by-four.column,.offset-by-four.columns{margin-left:34.6666666667%}.offset-by-five.column,.offset-by-five.columns{margin-left:43.3333333333%}.offset-by-six.column,.offset-by-six.columns{margin-left:52%}.offset-by-seven.column,.offset-by-seven.columns{margin-left:60.6666666667%}.offset-by-eight.column,.offset-by-eight.columns{margin-left:69.3333333333%}.offset-by-nine.column,.offset-by-nine.columns{margin-left:78%}.offset-by-ten.column,.offset-by-ten.columns{margin-left:86.6666666667%}.offset-by-eleven.column,.offset-by-eleven.columns{margin-left:95.3333333333%}.offset-by-one-third.column,.offset-by-one-third.columns{margin-left:34.6666666667%}.offset-by-two-thirds.column,.offset-by-two-thirds.columns{margin-left:69.3333333333%}.offset-by-one-half.column,.offset-by-one-half.columns{margin-left:52%}}html{font-size:62.5%}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;color:#222}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:2rem;font-weight:300}h1{font-size:4rem;line-height:1.2}h1,h2{letter-spacing:-.1rem}h2{font-size:3.6rem;line-height:1.25}h3{font-size:3rem;line-height:1.3;letter-spacing:-.1rem}h4{font-size:2.4rem;line-height:1.35;letter-spacing:-.08rem}h5{font-size:1.8rem;line-height:1.5;letter-spacing:-.05rem}h6{font-size:1.5rem;line-height:1.6;letter-spacing:0}@media (min-width:550px){h1{font-size:5rem}h2{font-size:4.2rem}h3{font-size:3.6rem}h4{font-size:3rem}h5{font-size:2.4rem}h6{font-size:1.5rem}}p{margin-top:0}a{color:#1eaedb}a:hover{color:#0fa0ce}.button,button,input[type=button],input[type=reset],input[type=submit]{display:inline-block;height:38px;padding:0 30px;color:#555;text-align:center;font-size:11px;font-weight:600;line-height:38px;letter-spacing:.1rem;text-transform:uppercase;text-decoration:none;white-space:nowrap;background-color:transparent;border-radius:4px;border:1px solid #bbb;cursor:pointer;box-sizing:border-box}.button:focus,.button:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{color:#333;border-color:#888;outline:0}.button.button-primary,button.button-primary,input[type=button].button-primary,input[type=reset].button-primary,input[type=submit].button-primary{color:#fff;background-color:#33c3f0;border-color:#33c3f0}.button.button-primary:focus,.button.button-primary:hover,button.button-primary:focus,button.button-primary:hover,input[type=button].button-primary:focus,input[type=button].button-primary:hover,input[type=reset].button-primary:focus,input[type=reset].button-primary:hover,input[type=submit].button-primary:focus,input[type=submit].button-primary:hover{color:#fff;background-color:#1eaedb;border-color:#1eaedb}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{height:38px;padding:6px 10px;background-color:#fff;border:1px solid #d1d1d1;border-radius:4px;box-shadow:none;box-sizing:border-box}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none}textarea{min-height:65px;padding-top:6px;padding-bottom:6px}input[type=email]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=url]:focus,select:focus,textarea:focus{border:1px solid #33c3f0;outline:0}label,legend{display:block;margin-bottom:.5rem;font-weight:600}fieldset{padding:0;border-width:0}input[type=checkbox],input[type=radio]{display:inline}label>.label-body{display:inline-block;margin-left:.5rem;font-weight:400}ul{list-style:circle inside}ol{list-style:decimal inside}ol,ul{padding-left:0;margin-top:0}ol ol,ol ul,ul ol,ul ul{margin:1.5rem 0 1.5rem 3rem;font-size:90%}li{margin-bottom:1rem}div.highlight{font-size:90%;white-space:nowrap;background:#f1f1f1;border:1px solid #e1e1e1;border-radius:4px;margin-bottom:2.5rem}code{padding:.2rem .5rem;margin:0 .2rem}pre>code{display:block;padding:1rem 1.5rem;white-space:pre}td,th{padding:12px 15px;text-align:left;border-bottom:1px solid #e1e1e1}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}.button,button{margin-bottom:1rem}fieldset,input,select,textarea{margin-bottom:1.5rem}blockquote,dl,figure,form,ol,p,pre,table,ul{margin-bottom:2.5rem}.u-full-width{width:100%;box-sizing:border-box}.u-max-full-width{max-width:100%;box-sizing:border-box}.u-pull-right{float:right}.u-pull-left{float:left}hr{margin-top:3rem;margin-bottom:3.5rem;border-width:0;border-top:1px solid #e1e1e1}.container:after,.row:after,.u-cf{content:"";display:table;clear:both}.highlight .hll{background-color:#ffc}.highlight .c{color:#999}.highlight .err{color:#a00;background-color:#faa}.highlight .k{color:#069}.highlight .o{color:#555}.highlight .cm{color:#09f;font-style:italic}.highlight .cp{color:#099}.highlight .c1,.highlight .cs{color:#999}.highlight .gd{background-color:#fcc;border:1px solid #c00}.highlight .ge{font-style:italic}.highlight .gr{color:red}.highlight .gh{color:#030}.highlight .gi{background-color:#cfc;border:1px solid #0c0}.highlight .go{color:#aaa}.highlight .gp{color:#009}.highlight .gu{color:#030}.highlight .gt{color:#9c6}.highlight .kc,.highlight .kd,.highlight .kn,.highlight .kp,.highlight .kr{color:#069}.highlight .kt{color:#078}.highlight .m{color:#f60}.highlight .s{color:#d44950}.highlight .na{color:#4f9fcf}.highlight .nb{color:#366}.highlight .nc{color:#0a8}.highlight .no{color:#360}.highlight .nd{color:#99f}.highlight .ni{color:#999}.highlight .ne{color:#c00}.highlight .nf{color:#c0f}.highlight .nl{color:#99f}.highlight .nn{color:#0cf}.highlight .nt{color:#2f6f9f}.highlight .nv{color:#033}.highlight .ow{color:#000}.highlight .w{color:#bbb}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#f60}.highlight .sb,.highlight .sc{color:#c30}.highlight .sd{color:#c30;font-style:italic}.highlight .s2,.highlight .se,.highlight .sh{color:#c30}.highlight .si{color:#a00}.highlight .sx{color:#c30}.highlight .sr{color:#3aa}.highlight .s1{color:#c30}.highlight .ss{color:#fc3}.highlight .bp{color:#366}.highlight .vc,.highlight .vg,.highlight .vi{color:#033}.highlight .il{color:#f60}.css .nt+.nt,.css .o,.css .o+.nt{color:#999}body{font-size:1.8em}h2,h4{font-size:2.6rem}@media (min-width:550px){h2,h4{font-size:2.7rem}}kbd{padding:.1em;border-radius:3px;border:1px solid #ccc;color:#333;display:inline-block;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 2px #fff;background-color:#f7f7f7;text-shadow:0 1px 0 #fff}figcaption{text-align:center;font-style:italic;color:#777;display:block;margin-bottom:2em}.sidebar h1{font-size:2.4em}.sidebar__sitetitle{color:#af0000}.sidebar__twitter{display:none;margin-top:2rem}.footer__twitter{display:none}.footer__copyright{float:right;font-size:.7em}.right-padded{padding-right:2rem}@media (max-width:550px){.sidebar h1,.sidebar p{margin-bottom:.5rem}.sidebar{padding-bottom:1rem;margin-bottom:1rem;border-bottom:1px solid grey}.footer__twitter{display:inline-block}}@media (min-width:550px){.sidebar h1{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);text-align:right;margin-top:150px;margin-bottom:100px}.sidebar__twitter{display:block}.copyright{margin-top:40px}}.sidebar p{text-align:justify;font-size:.8em}.sidebar h1 a{text-decoration:none}nav a{display:block}.pagination{margin-top:20px}.center,.pagination{text-align:center}.expand{width:80%}.teaser{margin-bottom:70px}.teaser .date{display:block;margin-top:-20px;margin-bottom:20px;text-align:right}.teaser h3 a{text-decoration:none}.page-info{text-align:right;margin-bottom:40px}article iframe,article img{display:block;margin:20px auto;max-width:100%}article div.highlight,article iframe,article img{box-shadow:0 8px 16px 0 rgba(0,0,0,.2),0 6px 20px 0 rgba(0,0,0,.19)}article div.highlight{scroll-behavior:auto}blockquote{background:#f9f9f9;border-left:10px solid #ccc;padding:.5em 10px;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:"\201D";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}div.seriestoc{background:#f9f9f9;border-left:10px solid #ccc;padding:.5em 10px;font-size:1em}div.seriestoc:before{color:#ccc;content:":";font-size:4em;font-family:helvetica;line-height:.1em;margin-right:.25em;vertical-align:-.4em}.blog-post__content>h3:first-of-type{text-align:right;border-radius:25px 25px 0 0;font-size:1.2em;background-color:#777;color:#fff;margin-bottom:0;padding:2px 20px 2px 0;font-style:italic}.blog-post__content>ol:first-of-type{list-style-type:upper-roman;background:#eff;border:1px solid #777;border-radius:0 0 25px 25px;margin-top:0;list-style-position:outside;padding:10px 10px 10px 45px}.blog-post__footer{margin:1rem 0 2rem}.article-tags{margin-left:.3rem}.article-tags--tag{margin-left:.5rem}.article-tags--tag:after{margin-left:.5rem;content:"|"}.article-tags--tag:last-child:after{content:""}.blog-post__pagination{display:flex;justify-content:space-between;margin-bottom:2rem}.blog-post__pagination--previous{text-decoration:none;margin:0 1rem}.blog-post__pagination--previous:hover{text-decoration:underline}.blog-post__pagination--previous:before{content:"\21A4   "}.blog-post__pagination--next:after{content:" \21A6"}.blog-post__pagination--next{text-decoration:none;margin:0 1rem}.blog-post__pagination--next:hover{text-decoration:underline}code.language-text{position:relative;padding:0;border-radius:.1em;margin-left:.2em;margin-right:.2em;color:#a55;border-bottom:1px solid rgba(200,100,100,.1);display:inline;white-space:normal}</style><meta name="generator" content="Gatsby 2.0.91"/><title data-react-helmet="true">FunSpIns - The hero must move, the enemies must move smarter.</title><link data-react-helmet="true" href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css"/><meta data-react-helmet="true" name="description" content="Content from Frank Quednau about dev and fields of interest."/><meta data-react-helmet="true" name="keywords" content="programming, haskell, fun-spin"/><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-87673c31a5b37b5e6556b63e1081ebbc.css"/><link rel="alternate" type="application/rss+xml" title="Realfiction RSS" href="/atom.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/component---src-templates-article-template-js-0d50b129641477731f1b.js"/><link as="script" rel="preload" href="/0-3fa69c1a4f2a06128c7c.js"/><link as="script" rel="preload" href="/1-b800af6eeb94a4b43009.js"/><link as="script" rel="preload" href="/app-7003a227919f11333437.js"/><link as="script" rel="preload" href="/webpack-runtime-f655ecba416e18cd3382.js"/><link as="fetch" rel="preload" href="/static/d/237/path---2013-09-24-funspins-the-hero-must-move-the-enemies-must-move-smarter-100-0ad-4tPJHuYmU8Hmau6ke8WQ7S6qo.json" crossOrigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="container"><div class="row"><div class="two columns right-padded"><div class="sidebar"><h1><a class="sidebar__sitetitle" href="/">Realfiction</a></h1><p>Content from Frank Quednau about dev and fields of interest.</p><nav><a href="/tags">Tags</a></nav><div class="sidebar__twitter"><a href="https://twitter.com/fquednau?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-show-count="false" data-show-screen-name="false">Follow @fquednau</a></div></div></div><div class="nine columns"><article><h1>FunSpIns - The hero must move, the enemies must move smarter.</h1><div class="page-info"><span>September 24, 2013</span> in<span class="article-tags"><a class="article-tags--tag" href="/tags/programming">programming</a><a class="article-tags--tag" href="/tags/haskell">haskell</a><a class="article-tags--tag" href="/tags/fun-spin">fun-spin</a></span></div><div class="blog-post__content"><h3>Functional space-invaders series</h3>
<ol>
<li><a href="/2013/09/17/funspins-a-recap-of-rob-ashtons-lessons-das-intro">A recap of Rob Ashton's lessons - Das Intro</a></li>
<li><a href="/2013/09/18/funspins-drawing-a-rectangle">Drawing a Rectangle</a></li>
<li><a href="/2013/09/19/funspins-moving-a-rectangle">Moving a Rectangle</a></li>
<li><a href="/2013/09/20/funspins-no-attributes-no-vectors-a-tiny-workflow-and-more-squares">No attributes, No vectors, A tiny Workflow and more squares</a></li>
<li><a href="/2013/09/23/funspins-state-the-world-the-loop">State, the World, the Loop</a></li>
<li>The hero must move, the enemies must move smarter</li>
<li><a href="/2013/09/25/funspins-the-hero-shoots">The hero shoots</a></li>
<li><a href="/2013/09/26/funspins-collisions-the-dead-and-a-not-so-grateful-ending">Collisions, the dead, and a (not so) grateful ending</a></li>
</ol>
<blockquote>
<p>Inspired by Rob Ashton's series "<a href="http://codeofrob.com/entries/learn-functional-programming-with-me---keyboard-input-for-our-red-square.html">Learn functional programming with me</a>"
It is time to feed things back to the actors! The actor signature did change a teeny bit:</p>
</blockquote>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">type</span> <span class="token constant">Point</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span><span class="token constant">Int</span><span class="token punctuation">)</span>
<span class="token keyword">data</span> <span class="token constant">ItemColor</span> <span class="token operator">=</span> <span class="token constant">White</span> <span class="token operator">|</span> <span class="token constant">Red</span> <span class="token operator">|</span> <span class="token constant">Black</span>
<span class="token keyword">data</span> <span class="token constant">WorldItem</span> <span class="token operator">=</span> <span class="token constant">WorldItem</span> <span class="token constant">Point</span> <span class="token constant">ItemColor</span>
<span class="token constant">World</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>That way we will be able to tell the rendering what colour we want our rectangles to be.</p>
<p>So, our enemies actor becomes:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">enemiesActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token hvariable">enemiesActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span>
	  <span class="token keyword">where</span>
	    <span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">enemyPosition</span> <span class="token operator">=</span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
	    <span class="token hvariable">enemies</span> <span class="token operator">=</span> <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
	    <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">rows</span><span class="token punctuation">,</span> <span class="token hvariable">cols</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
	      <span class="token builtin">map</span> <span class="token hvariable">enemy</span> <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">cols</span> <span class="token punctuation">[</span><span class="token hvariable">originX</span><span class="token punctuation">,</span><span class="token hvariable">originX</span><span class="token operator">+</span><span class="token number">60</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">y</span> <span class="token operator">&lt;-</span> <span class="token builtin">take</span> <span class="token hvariable">rows</span> <span class="token punctuation">[</span><span class="token hvariable">originY</span><span class="token punctuation">,</span><span class="token hvariable">originY</span><span class="token operator">+</span><span class="token number">30</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
	    <span class="token hvariable">enemy</span> <span class="token hvariable">p</span> <span class="token operator">=</span> <span class="token constant">WorldItem</span> <span class="token hvariable">p</span> <span class="token constant">White</span></code></pre></div>
<p>changeX is a new method with a pretty simple implementation:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">changeX</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">f</span> <span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span></code></pre></div>
<p>From which you can conclude that (+2) is actually a function, namely adding two to whatever supports adding twos to them.</p>
<p>Some changes where done on the loop. Indeed, there was no bail-out condition, which is introduced by checking whether 'x' is pressed.
Also, I don't want to react to any mouse events, hence it is sufficient to just pass on any key that is pressed by the gamer. The main and loop functions got some refactoring:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
	  <span class="token hvariable">canvas</span> <span class="token operator">&lt;-</span> <span class="token builtin">init</span>
	  <span class="token hvariable">loop</span> <span class="token operator">$</span> <span class="token hvariable">initWorld</span> <span class="token hvariable">canvas</span>
	  <span class="token keyword">where</span>
	    <span class="token builtin">init</span> <span class="token operator">=</span> <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">init</span> <span class="token punctuation">[</span><span class="token constant">InitVideo</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token hvariable">FX.setVideoMode</span> <span class="token number">640</span> <span class="token number">480</span> <span class="token number">32</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token hvariable">FX.getVideoSurface</span></code></pre></div>
<p>As you can see main is pretty much toned down to set up the SDL stuff and start looping with an initial version of our World. Loop became its own function:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">loop</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-></span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token hvariable">loop</span> <span class="token hvariable">world</span> <span class="token operator">=</span> <span class="token keyword">do</span>
	  <span class="token hvariable">FX.pollEvent</span> <span class="token operator">>>=</span> <span class="token hvariable">handleEvent</span>
	  <span class="token keyword">where</span>
	    <span class="token hvariable">handleEvent</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">x</span> <span class="token keyword">of</span>
	        <span class="token constant">KeyDown</span> <span class="token punctuation">(</span><span class="token constant">Keysym</span> <span class="token constant">SDLK_x</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token hvariable">FX.quit</span>
	        <span class="token constant">KeyDown</span> <span class="token punctuation">(</span><span class="token constant">Keysym</span> <span class="token hvariable">key</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token hvariable">render</span> <span class="token hvariable">key</span> <span class="token operator">>>=</span> <span class="token hvariable">loop</span>
	        <span class="token constant">KeyUp</span> <span class="token hvariable">_</span> <span class="token operator">-></span> <span class="token hvariable">render</span> <span class="token constant">SDLK_UNKNOWN</span> <span class="token operator">>>=</span> <span class="token hvariable">loop</span>
	        <span class="token hvariable">x</span> <span class="token operator">-></span> <span class="token hvariable">render</span> <span class="token punctuation">(</span><span class="token hvariable">lastKey</span> <span class="token hvariable">world</span><span class="token punctuation">)</span> <span class="token operator">>>=</span> <span class="token hvariable">loop</span>
	    <span class="token hvariable">render</span> <span class="token hvariable">e</span> <span class="token operator">=</span> <span class="token keyword">do</span>
	      <span class="token keyword">let</span> <span class="token hvariable">c</span> <span class="token operator">=</span> <span class="token hvariable">canvas</span> <span class="token hvariable">world</span>
	      <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">c</span> <span class="token constant">Nothing</span> <span class="token hvariable">black</span>
	      <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span><span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token builtin">foldl</span> <span class="token hvariable">runActor</span> <span class="token punctuation">(</span><span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">lastKey</span> <span class="token operator">=</span> <span class="token hvariable">e</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">actors</span> <span class="token hvariable">world</span>
	      <span class="token builtin">mapM</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">wi</span> <span class="token operator">-></span> <span class="token hvariable">FX.fillRect</span> <span class="token hvariable">c</span> <span class="token punctuation">(</span><span class="token hvariable">getRect</span> <span class="token hvariable">wi</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">getPixel</span> <span class="token hvariable">wi</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">items</span>
	      <span class="token constant">FX</span><span class="token punctuation">.</span><span class="token builtin">flip</span> <span class="token hvariable">c</span>
	      <span class="token hvariable">FX.delay</span> <span class="token number">40</span>
	      <span class="token builtin">return</span> <span class="token hvariable">newWorld</span>
	    <span class="token hvariable">runActor</span> <span class="token punctuation">(</span><span class="token hvariable">wld</span><span class="token punctuation">,</span> <span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token hvariable">actor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span> <span class="token hvariable">items</span><span class="token operator">++</span><span class="token hvariable">moreItems</span><span class="token punctuation">)</span>
	      <span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token hvariable">newWorld</span><span class="token punctuation">,</span><span class="token hvariable">moreItems</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">actor</span> <span class="token hvariable">wld</span></code></pre></div>
<p>the value of <strong>pollEvent</strong> is bound to the <strong>handleEvent</strong> function. That one is responsible for our bailout (matching on a keydown event where <strong>x</strong> is pressed), as well as keeping the loop going in any other event. </p>
<p>One speciality is that we extract the pressed key, and in case of any other event that may come through we do as if some unknown key would have been pressed. Hence, our World now does not keep the whole SDL event, but just the last key pressed. <strong>Also</strong>, while no KeyUp event is coming along, we moving the lastKey of the previous  world on to the next. This has the nice effect that our actors will react to the keydown event as long as the given key is pressed (<em>Your keyboard will thank me!</em>). <strong>getRect</strong> and <strong>getPixel</strong> functions are helpers to map from our <strong>WorldItem</strong> into the SDL data types.</p>
<p>Now that we have a nice key event hanging around in the <em>World</em>, let's get our hero into the equation:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">heroActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token hvariable">heroActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">hero</span> <span class="token hvariable">newState</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	  <span class="token keyword">where</span>
	    <span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token hvariable">lastKey</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
	      <span class="token constant">SDLK_LEFT</span> <span class="token operator">-></span> <span class="token hvariable">move</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	      <span class="token constant">SDLK_RIGHT</span> <span class="token operator">-></span> <span class="token hvariable">move</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>
	      <span class="token hvariable">_</span> <span class="token operator">-></span> <span class="token hvariable">w</span>
	    <span class="token hvariable">hero</span> <span class="token punctuation">(</span><span class="token constant">World</span> <span class="token punctuation">{</span> <span class="token hvariable">heroPosition</span> <span class="token operator">=</span> <span class="token hvariable">p</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">WorldItem</span> <span class="token hvariable">p</span> <span class="token constant">Red</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	    <span class="token hvariable">move</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">heroPosition</span> <span class="token operator">=</span> <span class="token hvariable">changeX</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">heroPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></code></pre></div>
<p>Depending on whether the user pressed left or right cursor key, we define the position of our hero in the World and create the corresponding <em>WorldItem</em>. I also need to match any other key, otherwise a <em>non-exhaustive pattern match</em> error will occur at runtime -  in this case we leave the world unchanged.</p>
<h3>Enemy movement</h3>
<p>Rob got somewhat ahead of me in that he has already sorted out the enemies moving from left to right and back, etc. - My enemies are currently edlessly wandering towards the left, leaving the screen and escaping the <em>righteous vengeance</em> of our world-defending hero.</p>
<p>For this I introduce a new state into the world:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">World</span> <span class="token operator">=</span> <span class="token constant">World</span> 
	<span class="token punctuation">{</span>
		<span class="token operator">...</span>
		<span class="token hvariable">enemyMovement</span> <span class="token operator">::</span> <span class="token constant">MovementPattern</span><span class="token punctuation">,</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span></code></pre></div>
<p>where <strong>MovementPattern</strong> is defined as </p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token keyword">type</span> <span class="token constant">MovementPattern</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Movement</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token constant">Bool</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">data</span> <span class="token constant">Movement</span> <span class="token operator">=</span> <span class="token constant">Rght</span> <span class="token operator">|</span> <span class="token constant">Dwn</span> <span class="token operator">|</span> <span class="token constant">Lft</span> <span class="token keyword">deriving</span> <span class="token constant">Show</span></code></pre></div>
<p>A pattern is therefore a number of Tuples consisting of a movement definition and a function that evaluates to true/false based on an input of Points. The way to use the pattern is as follows:</p>
<ul>
<li>Extract the points from whatever <strong>WorldItem</strong>s you want to consider</li>
<li>If the function of the first element evaluates to True, leave things as they are</li>
<li>If the function of the first element evaluates to False, roll over the pattern - first becomes last, second becomes first.</li>
</ul>
<p>So I go ahead and express that code-wise:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">evaluateMovePattern</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span><span class="token constant">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token constant">MovementPattern</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">Movement</span><span class="token punctuation">,</span><span class="token constant">MovementPattern</span><span class="token punctuation">)</span>
<span class="token hvariable">evaluateMovePattern</span> <span class="token hvariable">items</span> <span class="token hvariable">pattern</span> <span class="token operator">=</span> 
	<span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token hvariable">evaluate</span> <span class="token hvariable">items</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
		<span class="token constant">True</span> <span class="token operator">-></span> <span class="token hvariable">next</span> <span class="token hvariable">pattern</span>
		<span class="token constant">False</span> <span class="token operator">-></span> <span class="token hvariable">next</span> <span class="token hvariable">newPattern</span>
		<span class="token keyword">where</span> 
			<span class="token hvariable">evaluate</span> <span class="token operator">=</span> <span class="token builtin">snd</span> <span class="token operator">$</span> <span class="token builtin">head</span> <span class="token hvariable">pattern</span>
			<span class="token hvariable">next</span> <span class="token hvariable">p</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">nextMove</span> <span class="token hvariable">p</span><span class="token punctuation">,</span> <span class="token hvariable">p</span><span class="token punctuation">)</span>
			<span class="token hvariable">newPattern</span> <span class="token operator">=</span> <span class="token hvariable">roll</span> <span class="token hvariable">pattern</span>
			<span class="token hvariable">nextMove</span> <span class="token punctuation">(</span><span class="token hvariable">m</span><span class="token operator">:</span><span class="token hvariable">ms</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token builtin">fst</span> <span class="token hvariable">m</span></code></pre></div>
<p>where <strong>fst</strong>, <strong>snd</strong> are <a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html">Prelude</a> functions to extract the first and second value of a tuple, respectively. roll is just <strong>roll (x:xs) = xs++[x]</strong>.
Armed with the ability to evaluate a movement pattern, let's define one in the initialization of our World:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">initWorld</span> <span class="token hvariable">canvas</span> <span class="token operator">=</span> <span class="token constant">World</span> 
	<span class="token punctuation">{</span> 
		<span class="token operator">...</span> 
		<span class="token hvariable">enemyMovement</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">Rght</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">&lt;=</span><span class="token number">620</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token hvariable">maxX</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Dwn</span><span class="token punctuation">,</span><span class="token hvariable">alwaysFalse</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Lft</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token hvariable">minX</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">Dwn</span><span class="token punctuation">,</span><span class="token hvariable">alwaysFalse</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span>
<span class="token comment">-- with ..</span>
<span class="token hvariable">getX</span> <span class="token operator">::</span> <span class="token constant">Num</span> <span class="token hvariable">a</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token hvariable">a</span><span class="token punctuation">,</span><span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token hvariable">a</span>
<span class="token hvariable">getX</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">x</span>
<span class="token hvariable">boundX</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token hvariable">getX</span><span class="token operator"> . </span><span class="token punctuation">(</span><span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">comparing</span> <span class="token hvariable">getX</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token hvariable">maxX</span> <span class="token operator">=</span> <span class="token hvariable">boundX</span> <span class="token hvariable">maximumBy</span>
<span class="token hvariable">minX</span> <span class="token operator">=</span> <span class="token hvariable">boundX</span> <span class="token hvariable">minimumBy</span></code></pre></div>
<p>Hence, the pattern is right, while the maximum X of our point cloud is smaller than 620, the one time down (alwaysFalse returns false for whatever input), then left while the smallest X of the point cloud is bigger than 0, the one time down.</p>
<p>We can use this in our enemy actor to make sure that it moves properly throughout the screen:</p>
<div class="gatsby-highlight" data-language="haskell"><pre class="language-haskell"><code class="language-haskell">	<span class="token hvariable">enemiesActor</span> <span class="token operator">::</span> <span class="token constant">World</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">World</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token constant">WorldItem</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token hvariable">enemiesActor</span> <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">newState</span><span class="token punctuation">,</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span>
	  <span class="token keyword">where</span>
	    <span class="token hvariable">enemies</span> <span class="token operator">=</span> <span class="token hvariable">enemyGrid</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
	    <span class="token hvariable">newMovePattern</span> <span class="token operator">=</span> <span class="token hvariable">evaluateMovePattern</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token hvariable">getPoint</span> <span class="token hvariable">enemies</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">enemyMovement</span> <span class="token hvariable">w</span><span class="token punctuation">)</span>
	    <span class="token hvariable">requiredChange</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token builtin">fst</span> <span class="token hvariable">newMovePattern</span><span class="token punctuation">)</span> <span class="token keyword">of</span>
	      <span class="token constant">Rght</span> <span class="token operator">-></span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span>
	      <span class="token constant">Lft</span> <span class="token operator">-></span> <span class="token hvariable">changeX</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	      <span class="token constant">Dwn</span> <span class="token operator">-></span> <span class="token hvariable">changeY</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>
		<span class="token hvariable">newState</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token punctuation">{</span> <span class="token hvariable">enemyPosition</span> <span class="token operator">=</span> <span class="token hvariable">requiredChange</span> <span class="token punctuation">(</span><span class="token hvariable">enemyPosition</span> <span class="token hvariable">w</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">enemyMovement</span> <span class="token operator">=</span> <span class="token builtin">snd</span> <span class="token hvariable">newMovePattern</span> <span class="token punctuation">}</span>
		<span class="token operator">...</span></code></pre></div>
<p>Based on the current Movement, the enemy position is changed for the next iteration through our world.</p>
<p>At this point in the series we have...</p>
<ul>
<li>A bunch of enemies that move left to right, slowly coming down</li>
<li>A red hero that can be moved to the left and the right</li>
</ul>
<p>Doesn't sound terribly impressive, but the total LoC is about 117, and that from a FP noob, but we have still some way to go.</p></div><div class="blog-post__footer"><a href="https://mobile.twitter.com/search?q=https%3A%2F%2Frealfiction.net%2F2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter" target="_blank" rel="noopener noreferrer">Discuss on Twitter </a></div><div class="blog-post__pagination"><a class="blog-post__pagination--previous" href="/2013/09/23/funspins-state-the-world-the-loop">FunSpIns - State, the World, the Loop</a><a class="blog-post__pagination--next" href="/2013/09/25/funspins-the-hero-shoots">FunSpIns - The hero shoots.</a></div></article></div></div><div class="row"><div class="footer__twitter"><a href="https://twitter.com/fquednau?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-show-count="false" data-show-screen-name="false">Follow @fquednau</a></div><p class="footer__copyright"> Frank Quednau <!-- -->2019</p></div></div></div></div><script>
  window.excludeGAPaths=[/^(?:\/404)$/];
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1812710-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-article-template-js","jsonName":"2013-09-24-funspins-the-hero-must-move-the-enemies-must-move-smarter-100","path":"/2013/09/24/funspins-the-hero-must-move-the-enemies-must-move-smarter"};window.dataPath="237/path---2013-09-24-funspins-the-hero-must-move-the-enemies-must-move-smarter-100-0ad-4tPJHuYmU8Hmau6ke8WQ7S6qo";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.a03716562d1e590f30ef.css","/app-7003a227919f11333437.js"],"component---src-templates-article-template-js":["/component---src-templates-article-template-js-0d50b129641477731f1b.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-827eb0660badd62ebbc1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-7de7581acfdeae5a1ab6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-cc7c87d4d9fb6da3d023.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-bad0e5b91c4d33cf52ba.js"],"pages-manifest":["/pages-manifest-a6cd774493b2e7ddf8dd.js"]};/*]]>*/</script><script src="/webpack-runtime-f655ecba416e18cd3382.js" async=""></script><script src="/app-7003a227919f11333437.js" async=""></script><script src="/1-b800af6eeb94a4b43009.js" async=""></script><script src="/0-3fa69c1a4f2a06128c7c.js" async=""></script><script src="/component---src-templates-article-template-js-0d50b129641477731f1b.js" async=""></script></body></html>