{"data":{"markdownRemark":{"html":"<p>One of the new features in .NET 4.0 is the introduction of the dynamic keyword that delegates the check whether something can be called to the runtime. This supports the Dynamic Language runtime and allows .NEt code to call e.g. an object created by a ruby script without much syntax hassle. One unfortunate omission in this functionality is the ability to question an object of type dynamic whether it would accept a certain kind of call. Ruby knows such an operation, called respond_to. </p>\n<p>Introducing this functionality is quite easy in .NET as well by catching the <strong>RuntimeBinderException</strong> when calling some method on a dynamic. However, this is far from elegant (See <a href=\"http://ayende.com/Blog/archive/2010/06/23/challenge-dynamically-dynamic.aspx\">Challenge: Dynamically dynamic</a>). On standard .NET types, the information whether a specific member exists on some instance can be obtained via Reflection. Armed with this, it is possible to support an extension method that allows you to check whether a certain type supports some kind of property, or method call.</p>\n<p>You can find the relevant code as part of the MemBus project or as a gist (shown below, licensed under Apache 2.0). </p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SampleClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span>Name <span class=\"token operator\">=</span> <span class=\"token string\">\"Jones\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Has a public setter</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span>Birthdate <span class=\"token operator\">=</span> DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeFalse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Only has private setter</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span>Name <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeFalse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span><span class=\"token function\">SetDate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeFalse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//param is a DateTime, null not allowed</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span><span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span><span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeFalse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//param is string</span>\ns<span class=\"token punctuation\">.</span><span class=\"token function\">RespondsTo</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span><span class=\"token operator\">></span> d<span class=\"token punctuation\">.</span><span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bla\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bli\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ShouldBeFalse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Wrong number of args</span></code></pre></div>\n<p>A small part of the code was inspired by a <a href=\"http://justinmchase.com/post/2009/07/02/Member-Exists-e28093-Dynamic-C-40.aspx\">blog post from Justin Chase</a>.</p>","frontmatter":{"date":"July 16, 2010","path":null,"title":"respond_to in .NET","tags":["ruby","csharp"]}}},"pageContext":{"title":"respond_to in .NET","previous":{"fields":{"slug":"/2010/05/26/do-you-think-your-windows-forms-application-has-no-memory-leaks"},"frontmatter":{"title":"Do you think your Windows.Forms Application has no memory leaks?","tags":["software-development","dotnet","windows","csharp"],"date":"2010/05/26"}},"next":{"fields":{"slug":"/2010/07/30/wcf-externalize-binding-configuration-only"},"frontmatter":{"title":"WCF: Externalize Binding Configuration Only","tags":["libs-and-frameworks","csharp"],"date":"2010/07/30"}}}}