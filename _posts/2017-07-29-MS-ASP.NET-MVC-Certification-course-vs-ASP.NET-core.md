---
title: "MS ASP.NET MVC Certification course vs ASP.NET core"
layout: post
tags: [web,programming,dotnet]
date: 2017-07-29 21:38:46
---

When you do the MS exams to become a cerified developer you may come across the 486 course. The [supporting video][1] for that is 4 years old and based on MVC 4. This post will keep just a few notes as to whether the info in there still holds up in the light of .NET Core. The code is [checked in][2], the commits more or less follow the progress made in the videos on channel 9.

### Video 1 - Introduction

To get ourselves an mvc app we can do

```bash
dotnet new web
dotnet add package Microsoft.AspnetCore.Mvc
dotnet add package Microsoft.AspnetCore.StaticFiles
```
I deliberately started fom an _empty_ web project, because I am a purist like that. You could also do `dotnet new mvc` and have a ton of stuff and an application that can run. To be honest, what put me off where the bower references. I am not going to start getting aquainted with bower at this point int time.

Anyhow, you can hook up the MVC functionality yourself into the basic web application startup:

```csharp
services.AddMvc(); //In "ConfigureServices"
...
app.UseStaticFiles();
app.UseMvc(routes =>
{
    routes.MapRoute(
        name: "default",
        template: "{controller=Home}/{action=Index}/{id?}");
}); // In "Configure"
```

Then we need

* __Controllers__ and __Views__ folders
* A __HomeController__, an __Index__ view, maybe a __Layout__

and off you go. So far, pretty much the same stuff.


### Video 2 - Models

OMG, Entity Framework, really now?

Oh well, I said I would follow along, so here we go:

```bash
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
```

Now we wire up tha database stuff on Startup...

```csharp
// In "ConfigureServices"
services.AddDbContext<ConferenceContext>(opt => opt.UseSqlServer(
  "Server=(localdb)\\mssqllocaldb;Database=Conferences;" +
  "Trusted_Connection=True;MultipleActiveResultSets=true"));
```
That local db file will btw end up in your user directory (i.e. ~), I was too lazy to parse through changing the default, 
so I stuck with it (With frameworks & dependencies like that, just go with the flow, you will thank me when you have time
to go have drinks on the weekend)

The ConferenceContext is [over here][3], then there is some initialization code, [hand-written][4]. I didn't find that
fancy __DropCreateAlwaysDatabaseInitializer__ thing mentioned in the video, but this is about MVC, not EF, so I didn't search very hard.
The initializer will do fine, I'm sure.

We call it in Startup's `Configure`:

```csharp
public void Configure(..., ConferenceContext dbContext)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
        DbInitializer.Initialize(dbContext);
    }
}
```
By configuring the EF stuff into the in-built DI Container, we could just let the framework provide us with a db Context. If you want to know more about EF on .NET Core, [this page][5] is a good starting point.

The `ComponentModel` namespace is around, so you can attribute your models like crazy, just like in the video.

### Video 3- Controllers

tba



[1]: https://channel9.msdn.com/Series/Dev-ASP-MVC4-WebApps/01y
[2]: https://github.com/flq/MS486Core
[3]: https://github.com/flq/MS486Core/blob/master/Database/ConferenceContext.cs
[4]: https://github.com/flq/MS486Core/blob/master/Database/DbInitializer.cs
[5]: https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/intro